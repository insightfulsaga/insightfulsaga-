"use strict";(self.webpackChunkdatacraft_school=self.webpackChunkdatacraft_school||[]).push([[5605],{6584:(e,r,s)=>{s.r(r),s.d(r,{assets:()=>c,contentTitle:()=>d,default:()=>h,frontMatter:()=>l,metadata:()=>n,toc:()=>o});const n=JSON.parse('{"id":"logistic-regression-model","title":"Logistic Regression - Explained Simply","description":"\ud83d\ude80 Churn Predictor: Building an ML Model for Streaming Service","source":"@site/docs-pyspark/logistic-regression-model.md","sourceDirName":".","slug":"/logistic-regression-model","permalink":"/pyspark/logistic-regression-model","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"logistic-regression-model","title":"Logistic Regression - Explained Simply","sidebar_label":"Logistic Regression"}}');var i=s(4848),t=s(8453);const l={id:"logistic-regression-model",title:"Logistic Regression - Explained Simply",sidebar_label:"Logistic Regression"},d=void 0,c={},o=[{value:"\ud83d\ude80 Churn Predictor: Building an ML Model for Streaming Service",id:"-churn-predictor-building-an-ml-model-for-streaming-service",level:2},{value:"\ud83d\udce6 Step 1: Gather the Data",id:"-step-1-gather-the-data",level:4},{value:"\ud83e\uddf9 Step 2: Clean and Prepare",id:"-step-2-clean-and-prepare",level:4},{value:"\ud83c\udfd7\ufe0f Step 3: Feature Engineering",id:"\ufe0f-step-3-feature-engineering",level:4},{value:"\ud83e\udd16 Step 4: Train the Model",id:"-step-4-train-the-model",level:4},{value:"\ud83d\udcca Step 5: Test and Evaluate",id:"-step-5-test-and-evaluate",level:4},{value:"Step 0: Sample Data (Before transformation)",id:"step-0-sample-data-before-transformation",level:3},{value:"Step 1: Converting text to numeric \u2014 \u201cSex\u201d and \u201cEmbarked\u201d",id:"step-1-converting-text-to-numeric--sex-and-embarked",level:3},{value:"Step 2: Vector Assembler \u2014 \u201cPacking your travel bag\u201d",id:"step-2-vector-assembler--packing-your-travel-bag",level:3},{value:"Step 3: Logistic Regression \u2014 \u201cThe Spell of Survival Odds\u201d",id:"step-3-logistic-regression--the-spell-of-survival-odds",level:3},{value:"Step 4: Evaluate \u2014 \u201cHow good is your spell?\u201d",id:"step-4-evaluate--how-good-is-your-spell",level:3},{value:"Narrated Explanation of Key Components",id:"narrated-explanation-of-key-components",level:2},{value:"\ud83e\udded 1-Minute Recap: Linear Regression",id:"-1-minute-recap-linear-regression",level:2}];function a(e){const r={code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.h2,{id:"-churn-predictor-building-an-ml-model-for-streaming-service",children:"\ud83d\ude80 Churn Predictor: Building an ML Model for Streaming Service"}),"\n",(0,i.jsx)(r.p,{children:"\ud83d\udc40 Imagine This:"}),"\n",(0,i.jsx)(r.p,{children:"You\u2019re a data scientist at a fast-growing streaming platform called Streamly. Your mission? Build a Churn Predictor \u2014 a smart system that guesses whether a user will cancel their subscription next month (1 = yes, 0 = no) based on their usage data."}),"\n",(0,i.jsx)(r.p,{children:"Let\u2019s walk through how you\u2019d tackle this, step by step \u2014 just like a real-world ML project."}),"\n",(0,i.jsx)(r.h4,{id:"-step-1-gather-the-data",children:"\ud83d\udce6 Step 1: Gather the Data"}),"\n",(0,i.jsx)(r.p,{children:"You collect raw user data:"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:"User demographics (age, gender, location)"}),"\n",(0,i.jsx)(r.li,{children:"Subscription plan type"}),"\n",(0,i.jsx)(r.li,{children:"Viewing habits (hours watched, number of sessions)"}),"\n",(0,i.jsx)(r.li,{children:"Customer support interactions"}),"\n",(0,i.jsx)(r.li,{children:"Payment history"}),"\n"]}),"\n",(0,i.jsx)(r.p,{children:"And the key outcome: churned or not"}),"\n",(0,i.jsx)(r.h4,{id:"-step-2-clean-and-prepare",children:"\ud83e\uddf9 Step 2: Clean and Prepare"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:"Real-world data is messy."}),"\n",(0,i.jsx)(r.li,{children:"Some users have missing age or location \u2014 you fill those gaps with median values or common categories."}),"\n",(0,i.jsx)(r.li,{children:"Text fields like gender and plan type are converted into numerical labels."}),"\n",(0,i.jsx)(r.li,{children:"You remove irrelevant columns like user ID or signup timestamp, which don\u2019t help prediction."}),"\n"]}),"\n",(0,i.jsx)(r.h4,{id:"\ufe0f-step-3-feature-engineering",children:"\ud83c\udfd7\ufe0f Step 3: Feature Engineering"}),"\n",(0,i.jsx)(r.p,{children:"You build a \u201cfeature bag\u201d with variables likely to influence churn:"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:"Average weekly watch time"}),"\n",(0,i.jsx)(r.li,{children:"Number of active days in the last month"}),"\n",(0,i.jsx)(r.li,{children:"Whether they contacted support recently"}),"\n",(0,i.jsx)(r.li,{children:"Payment failure counts"}),"\n",(0,i.jsx)(r.li,{children:"Subscription tier (basic, standard, premium)"}),"\n",(0,i.jsx)(r.li,{children:"Demographic features (age group, region)"}),"\n"]}),"\n",(0,i.jsx)(r.h4,{id:"-step-4-train-the-model",children:"\ud83e\udd16 Step 4: Train the Model"}),"\n",(0,i.jsx)(r.p,{children:"You use Logistic Regression \u2014 a straightforward, interpretable classifier \u2014 to learn patterns from historical user behavior."}),"\n",(0,i.jsx)(r.p,{children:"The model figures out, for example:"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:"Users with low watch time are more likely to churn."}),"\n",(0,i.jsx)(r.li,{children:"Premium subscribers churn less often."}),"\n",(0,i.jsx)(r.li,{children:"Frequent payment issues increase churn risk."}),"\n"]}),"\n",(0,i.jsx)(r.h4,{id:"-step-5-test-and-evaluate",children:"\ud83d\udcca Step 5: Test and Evaluate"}),"\n",(0,i.jsx)(r.p,{children:"You evaluate your model on a holdout set using AUC \u2014 to check how well it distinguishes churners from loyal users.\r\nAn AUC score around 0.85 tells you the model is pretty good at predicting who\u2019s likely to leave."}),"\n",(0,i.jsx)(r.h3,{id:"step-0-sample-data-before-transformation",children:"Step 0: Sample Data (Before transformation)"}),"\n",(0,i.jsx)(r.p,{children:"Let\u2019s suppose your raw data has 6 rows:"}),"\n",(0,i.jsxs)(r.table,{children:[(0,i.jsx)(r.thead,{children:(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.th,{children:"Survived"}),(0,i.jsx)(r.th,{children:"Pclass"}),(0,i.jsx)(r.th,{children:"Sex"}),(0,i.jsx)(r.th,{children:"Age"}),(0,i.jsx)(r.th,{children:"SibSp"}),(0,i.jsx)(r.th,{children:"Parch"}),(0,i.jsx)(r.th,{children:"Fare"}),(0,i.jsx)(r.th,{children:"Embarked"})]})}),(0,i.jsxs)(r.tbody,{children:[(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"0"}),(0,i.jsx)(r.td,{children:"3"}),(0,i.jsx)(r.td,{children:"male"}),(0,i.jsx)(r.td,{children:"22.0"}),(0,i.jsx)(r.td,{children:"1"}),(0,i.jsx)(r.td,{children:"0"}),(0,i.jsx)(r.td,{children:"7.25"}),(0,i.jsx)(r.td,{children:"S"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"1"}),(0,i.jsx)(r.td,{children:"1"}),(0,i.jsx)(r.td,{children:"female"}),(0,i.jsx)(r.td,{children:"38.0"}),(0,i.jsx)(r.td,{children:"1"}),(0,i.jsx)(r.td,{children:"0"}),(0,i.jsx)(r.td,{children:"71.283"}),(0,i.jsx)(r.td,{children:"C"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"1"}),(0,i.jsx)(r.td,{children:"3"}),(0,i.jsx)(r.td,{children:"female"}),(0,i.jsx)(r.td,{children:"26.0"}),(0,i.jsx)(r.td,{children:"0"}),(0,i.jsx)(r.td,{children:"0"}),(0,i.jsx)(r.td,{children:"7.925"}),(0,i.jsx)(r.td,{children:"S"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"1"}),(0,i.jsx)(r.td,{children:"1"}),(0,i.jsx)(r.td,{children:"female"}),(0,i.jsx)(r.td,{children:"35.0"}),(0,i.jsx)(r.td,{children:"1"}),(0,i.jsx)(r.td,{children:"0"}),(0,i.jsx)(r.td,{children:"53.100"}),(0,i.jsx)(r.td,{children:"S"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"0"}),(0,i.jsx)(r.td,{children:"3"}),(0,i.jsx)(r.td,{children:"male"}),(0,i.jsx)(r.td,{children:"35.0"}),(0,i.jsx)(r.td,{children:"0"}),(0,i.jsx)(r.td,{children:"0"}),(0,i.jsx)(r.td,{children:"8.050"}),(0,i.jsx)(r.td,{children:"S"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"0"}),(0,i.jsx)(r.td,{children:"2"}),(0,i.jsx)(r.td,{children:"male"}),(0,i.jsx)(r.td,{children:"27.0"}),(0,i.jsx)(r.td,{children:"0"}),(0,i.jsx)(r.td,{children:"0"}),(0,i.jsx)(r.td,{children:"21.000"}),(0,i.jsx)(r.td,{children:"S"})]})]})]}),"\n",(0,i.jsx)(r.p,{children:"This is the \u201cbefore\u201d raw table in Spark (i.e. what final_data.show() would show before transformations)."}),"\n",(0,i.jsx)(r.h3,{id:"step-1-converting-text-to-numeric--sex-and-embarked",children:"Step 1: Converting text to numeric \u2014 \u201cSex\u201d and \u201cEmbarked\u201d"}),"\n",(0,i.jsx)(r.p,{children:"The Logistic Regression spell requires numeric features only. So we convert:"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:"Sex (\u201cmale\u201d, \u201cfemale\u201d) \u2192 an index \u2192 one-hot vector"}),"\n",(0,i.jsx)(r.li,{children:"Embarked (\u201cS\u201d, \u201cC\u201d, \u201cQ\u201d, etc.) \u2192 index \u2192 one-hot vector"}),"\n"]}),"\n",(0,i.jsx)(r.p,{children:"In our story:"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:"You ask an indexer to assign \u201cfemale\u201d \u2192 0, \u201cmale\u201d \u2192 1 (or vice versa)"}),"\n",(0,i.jsx)(r.li,{children:"Then you transform that index into a binary vector [1, 0] or [0, 1]"}),"\n",(0,i.jsx)(r.li,{children:"Similarly for Embarked: maybe \u201cS\u201d\u21920, \u201cC\u201d\u21921, \u201cQ\u201d\u21922, then one-hot [1,0,0], [0,1,0] or [0,0,1]."}),"\n"]}),"\n",(0,i.jsx)(r.p,{children:"So after the transformation, row 1 (female) might have:"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:"SexIndex = 0"}),"\n",(0,i.jsx)(r.li,{children:"SexVec = [1.0, 0.0] (assuming female is first)"}),"\n",(0,i.jsx)(r.li,{children:"EmbarkedIndex = 0"}),"\n",(0,i.jsx)(r.li,{children:"EmbarkedVec = [1.0, 0.0, 0.0]"}),"\n"]}),"\n",(0,i.jsx)(r.p,{children:"Thus the row becomes:"}),"\n",(0,i.jsxs)(r.table,{children:[(0,i.jsx)(r.thead,{children:(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.th,{children:"Survived"}),(0,i.jsx)(r.th,{children:"Pclass"}),(0,i.jsx)(r.th,{children:(0,i.jsx)(r.strong,{children:"SexVec"})}),(0,i.jsx)(r.th,{children:"Age"}),(0,i.jsx)(r.th,{children:"SibSp"}),(0,i.jsx)(r.th,{children:"Parch"}),(0,i.jsx)(r.th,{children:"Fare"}),(0,i.jsx)(r.th,{children:(0,i.jsx)(r.strong,{children:"EmbarkedVec"})})]})}),(0,i.jsxs)(r.tbody,{children:[(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"0"}),(0,i.jsx)(r.td,{children:"3"}),(0,i.jsx)(r.td,{children:"[0,1]"}),(0,i.jsx)(r.td,{children:"22.0"}),(0,i.jsx)(r.td,{children:"1"}),(0,i.jsx)(r.td,{children:"0"}),(0,i.jsx)(r.td,{children:"7.25"}),(0,i.jsx)(r.td,{children:"[1,0,0]"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"1"}),(0,i.jsx)(r.td,{children:"1"}),(0,i.jsx)(r.td,{children:"[1,0]"}),(0,i.jsx)(r.td,{children:"38.0"}),(0,i.jsx)(r.td,{children:"1"}),(0,i.jsx)(r.td,{children:"0"}),(0,i.jsx)(r.td,{children:"71.283"}),(0,i.jsx)(r.td,{children:"[0,1,0]"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"\u2026"}),(0,i.jsx)(r.td,{}),(0,i.jsx)(r.td,{}),(0,i.jsx)(r.td,{}),(0,i.jsx)(r.td,{}),(0,i.jsx)(r.td,{}),(0,i.jsx)(r.td,{}),(0,i.jsx)(r.td,{})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"You don\u2019t see separate SexIndex and EmbarkedIndex columns in the final features \u2014 you only use the one-hot vectors for modeling."}),(0,i.jsx)(r.td,{}),(0,i.jsx)(r.td,{}),(0,i.jsx)(r.td,{}),(0,i.jsx)(r.td,{}),(0,i.jsx)(r.td,{}),(0,i.jsx)(r.td,{}),(0,i.jsx)(r.td,{})]})]})]}),"\n",(0,i.jsx)(r.h3,{id:"step-2-vector-assembler--packing-your-travel-bag",children:"Step 2: Vector Assembler \u2014 \u201cPacking your travel bag\u201d"}),"\n",(0,i.jsx)(r.p,{children:"Now you have multiple pieces: Pclass (integer), SexVec (vector of length 2), Age (float), SibSp, Parch, Fare, EmbarkedVec (vector of length 3). The VectorAssembler takes all these into a single feature vector column named, say, features."}),"\n",(0,i.jsx)(r.p,{children:"So the row becomes:"}),"\n",(0,i.jsxs)(r.table,{children:[(0,i.jsx)(r.thead,{children:(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.th,{children:"Survived"}),(0,i.jsx)(r.th,{children:"features"})]})}),(0,i.jsxs)(r.tbody,{children:[(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"0"}),(0,i.jsx)(r.td,{children:"[3.0, 0.0, 1.0, 22.0, 1.0, 0.0, 7.25, 1.0,0.0,0.0]"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"1"}),(0,i.jsx)(r.td,{children:"[1.0, 1.0, 0.0, 38.0, 1.0, 0.0, 71.283, 0.0,1.0,0.0]"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"\u2026"}),(0,i.jsx)(r.td,{children:"\u2026"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"(This vector concatenates: Pclass, SexVec (2 dims), Age, SibSp, Parch, Fare, EmbarkedVec (3 dims).)"}),(0,i.jsx)(r.td,{})]})]})]}),"\n",(0,i.jsx)(r.h3,{id:"step-3-logistic-regression--the-spell-of-survival-odds",children:"Step 3: Logistic Regression \u2014 \u201cThe Spell of Survival Odds\u201d"}),"\n",(0,i.jsx)(r.p,{children:"Now you cast the logistic regression spell.\r\nIntuitively:"}),"\n",(0,i.jsxs)(r.p,{children:["You want to learn a function ",(0,i.jsx)(r.strong,{children:"\ud835\udc5d=\ud835\udf0e(\ud835\udc64\ud835\udc47\ud835\udc65+\ud835\udc4f)p=\u03c3(wTx+b)"})," that gives the probability of survival \ud835\udc5dp for a passenger with features x."]}),"\n",(0,i.jsx)(r.p,{children:"If p > 0.5 (or some threshold), you guess survived (1); otherwise death (0)."}),"\n",(0,i.jsx)(r.p,{children:"Logistic regression learns the weights \ud835\udc64 and bias \ud835\udc4f that best separate the survivors from non\u2011survivors, by maximizing likelihood (or minimizing log loss)."}),"\n",(0,i.jsx)(r.p,{children:"After training, for a test passenger, it produces:"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"rawPrediction"})," (a pair of scores, e.g. [score0, score1])"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"probability"})," (e.g. [0.28, 0.72])"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"prediction"})," (0 or 1) \u2014 where it picks the class with higher score."]}),"\n"]}),"\n",(0,i.jsxs)(r.p,{children:["So if for a passenger we get ",(0,i.jsx)(r.strong,{children:"prediction = 1"}),", we say \u201cour spell guesses they survived.\u201d"]}),"\n",(0,i.jsx)(r.h3,{id:"step-4-evaluate--how-good-is-your-spell",children:"Step 4: Evaluate \u2014 \u201cHow good is your spell?\u201d"}),"\n",(0,i.jsx)(r.p,{children:"You need to judge how accurate your predictions are. Suppose on test data you see:"}),"\n",(0,i.jsxs)(r.table,{children:[(0,i.jsx)(r.thead,{children:(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.th,{children:"Survived"}),(0,i.jsx)(r.th,{children:"prediction"})]})}),(0,i.jsxs)(r.tbody,{children:[(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"0"}),(0,i.jsx)(r.td,{children:"0"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"1"}),(0,i.jsx)(r.td,{children:"1"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"0"}),(0,i.jsx)(r.td,{children:"1"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"1"}),(0,i.jsx)(r.td,{children:"1"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"0"}),(0,i.jsx)(r.td,{children:"0"})]})]})]}),"\n",(0,i.jsx)(r.p,{children:"You have false positives, false negatives etc."}),"\n",(0,i.jsxs)(r.p,{children:["The ",(0,i.jsx)(r.strong,{children:"BinaryClassificationEvaluator"})," (with metric \u201careaUnderROC\u201d by default) computes AUC (Area under ROC curve). This measures how well your model separates the classes across all thresholds."]}),"\n",(0,i.jsx)(r.p,{children:"If AUC = 0.85, it means your spell (model) is pretty good: when it says \u201chigher score \u2192 survived,\u201d it's quite accurate."}),"\n",(0,i.jsx)(r.h2,{id:"narrated-explanation-of-key-components",children:"Narrated Explanation of Key Components"}),"\n",(0,i.jsx)(r.p,{children:"Here\u2019s how you could explain each in story form:"}),"\n",(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.strong,{children:"StringIndexer:"})," \u201cYou ask your indexer scribe: 'For each text label, assign a unique number so that the spell machines can handle it.'\u201d"]}),"\n",(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.strong,{children:"OneHotEncoder:"})," \u201cNow that you have numbers, you transform each into a one-hot flag array \u2014 kind of like picking which colored gem lights up for that label.\u201d"]}),"\n",(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.strong,{children:"VectorAssembler:"})," \u201cYou gather all the little features and pack them into a single magical satchel called features.\u201d"]}),"\n",(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.strong,{children:"Pipeline:"})," \u201cYou chain your steps \u2014 transformation spells + logistic spell \u2014 into a single pipeline, so you can do fit and transform in one shot.\u201d"]}),"\n",(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.strong,{children:"LogisticRegression:"})," \u201cThe heart of the spell \u2014 it learns how each feature nudges survival odds, and computes a probability.\u201d"]}),"\n",(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.strong,{children:"BinaryClassificationEvaluator:"})," \u201cYou need a judge. This metric tool looks at predictions and true labels and gives you a single score (AUC) on how well your spell performed overall.\u201d"]}),"\n",(0,i.jsx)(r.h2,{id:"-1-minute-recap-linear-regression",children:"\ud83e\udded 1-Minute Recap: Linear Regression"}),"\n",(0,i.jsxs)(r.table,{children:[(0,i.jsx)(r.thead,{children:(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.th,{children:(0,i.jsx)(r.strong,{children:"Step"})}),(0,i.jsx)(r.th,{children:(0,i.jsx)(r.strong,{children:"Description"})}),(0,i.jsx)(r.th,{children:(0,i.jsx)(r.strong,{children:"Key Concepts / Tools"})}),(0,i.jsx)(r.th,{children:(0,i.jsx)(r.strong,{children:"Purpose / Output"})})]})}),(0,i.jsxs)(r.tbody,{children:[(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.strong,{children:"1. Gather"})}),(0,i.jsx)(r.td,{children:"Collect user data (demographics, usage, payments)"}),(0,i.jsx)(r.td,{children:"Raw attributes"}),(0,i.jsx)(r.td,{children:"Prepare input features + target (churn)"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.strong,{children:"2. Clean"})}),(0,i.jsx)(r.td,{children:"Fill missing values, drop irrelevant fields"}),(0,i.jsx)(r.td,{children:"Imputation, Label Encoding"}),(0,i.jsx)(r.td,{children:"Make data usable for modeling"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.strong,{children:"3. Feature Engineering"})}),(0,i.jsx)(r.td,{children:"Create meaningful features like watch time, support contact"}),(0,i.jsx)(r.td,{children:"Derived metrics"}),(0,i.jsx)(r.td,{children:"Capture churn signals"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.strong,{children:"4. Train"})}),(0,i.jsx)(r.td,{children:"Fit Logistic Regression model"}),(0,i.jsx)(r.td,{children:"Logistic Regression"}),(0,i.jsx)(r.td,{children:"Learn patterns linked to churn"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.strong,{children:"5. Evaluate"})}),(0,i.jsx)(r.td,{children:"Test on holdout data using AUC metric"}),(0,i.jsx)(r.td,{children:"BinaryClassificationEvaluator"}),(0,i.jsx)(r.td,{children:"Check model quality (e.g., AUC = 0.85)"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.strong,{children:"Text \u2192 Numeric"})}),(0,i.jsx)(r.td,{children:'Convert "Sex", "Embarked" to index + one-hot'}),(0,i.jsx)(r.td,{children:"StringIndexer, OneHotEncoder"}),(0,i.jsx)(r.td,{children:"Make categorical features usable"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.strong,{children:"Assemble Features"})}),(0,i.jsx)(r.td,{children:"Combine all into a single vector"}),(0,i.jsx)(r.td,{children:"VectorAssembler"}),(0,i.jsxs)(r.td,{children:["Create final input column: ",(0,i.jsx)(r.code,{children:"features"})]})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.strong,{children:"Prediction Output"})}),(0,i.jsx)(r.td,{children:"Model gives score + probability + prediction"}),(0,i.jsxs)(r.td,{children:[(0,i.jsx)(r.code,{children:"rawPrediction"}),", ",(0,i.jsx)(r.code,{children:"probability"}),", ",(0,i.jsx)(r.code,{children:"prediction"})]}),(0,i.jsx)(r.td,{children:"Decide churn (1) or not (0)"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.strong,{children:"Evaluate Prediction"})}),(0,i.jsx)(r.td,{children:"Check how well prediction matches true label"}),(0,i.jsx)(r.td,{children:"AUC (Area Under ROC)"}),(0,i.jsx)(r.td,{children:"Measure performance objectively"})]})]})]})]})}function h(e={}){const{wrapper:r}={...(0,t.R)(),...e.components};return r?(0,i.jsx)(r,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},8453:(e,r,s)=>{s.d(r,{R:()=>l,x:()=>d});var n=s(6540);const i={},t=n.createContext(i);function l(e){const r=n.useContext(t);return n.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function d(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),n.createElement(t.Provider,{value:r},e.children)}}}]);