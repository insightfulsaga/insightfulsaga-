"use strict";(self.webpackChunkdatacraft_school=self.webpackChunkdatacraft_school||[]).push([[4602],{5453:(e,a,n)=>{n.r(a),n.d(a,{assets:()=>o,contentTitle:()=>t,default:()=>c,frontMatter:()=>l,metadata:()=>s,toc:()=>p});const s=JSON.parse('{"id":"df-missing-data","title":"Handling Missing Data \u2014 Drop, Fill & Replace","description":"Learn how to handle missing data in PySpark DataFrames using drop, fill, and replace operations with practical Databricks examples.","source":"@site/docs-pyspark/df-missing-data.md","sourceDirName":".","slug":"/df-missing-data","permalink":"/pyspark/df-missing-data","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"PySpark","permalink":"/pyspark/tags/py-spark"},{"inline":true,"label":"Apache Spark","permalink":"/pyspark/tags/apache-spark"},{"inline":true,"label":"Big Data","permalink":"/pyspark/tags/big-data"},{"inline":true,"label":"Spark Basics","permalink":"/pyspark/tags/spark-basics"},{"inline":true,"label":"Cluster Computing","permalink":"/pyspark/tags/cluster-computing"},{"inline":true,"label":"Spark Architecture","permalink":"/pyspark/tags/spark-architecture"},{"inline":true,"label":"Driver Program","permalink":"/pyspark/tags/driver-program"},{"inline":true,"label":"Executors","permalink":"/pyspark/tags/executors"},{"inline":true,"label":"Cluster Manager","permalink":"/pyspark/tags/cluster-manager"},{"inline":true,"label":"SparkSession","permalink":"/pyspark/tags/spark-session"},{"inline":true,"label":"SparkContext","permalink":"/pyspark/tags/spark-context"},{"inline":true,"label":"RDD","permalink":"/pyspark/tags/rdd"},{"inline":true,"label":"RDD Transformations","permalink":"/pyspark/tags/rdd-transformations"},{"inline":true,"label":"RDD Actions","permalink":"/pyspark/tags/rdd-actions"},{"inline":true,"label":"Key-Value RDD","permalink":"/pyspark/tags/key-value-rdd"},{"inline":true,"label":"RDD Caching","permalink":"/pyspark/tags/rdd-caching"},{"inline":true,"label":"DataFrame","permalink":"/pyspark/tags/data-frame"},{"inline":true,"label":"DataFrame API","permalink":"/pyspark/tags/data-frame-api"},{"inline":true,"label":"Column Operations","permalink":"/pyspark/tags/column-operations"},{"inline":true,"label":"DataFrame Joins","permalink":"/pyspark/tags/data-frame-joins"},{"inline":true,"label":"Aggregations","permalink":"/pyspark/tags/aggregations"},{"inline":true,"label":"GroupBy","permalink":"/pyspark/tags/group-by"},{"inline":true,"label":"Window Functions","permalink":"/pyspark/tags/window-functions"},{"inline":true,"label":"Missing Data Handling","permalink":"/pyspark/tags/missing-data-handling"},{"inline":true,"label":"Spark SQL","permalink":"/pyspark/tags/spark-sql"},{"inline":true,"label":"Temp Views","permalink":"/pyspark/tags/temp-views"},{"inline":true,"label":"Spark SQL Functions","permalink":"/pyspark/tags/spark-sql-functions"},{"inline":true,"label":"UDF","permalink":"/pyspark/tags/udf"},{"inline":true,"label":"UDAF","permalink":"/pyspark/tags/udaf"}],"version":"current","frontMatter":{"id":"df-missing-data","title":"Handling Missing Data \u2014 Drop, Fill & Replace","sidebar_label":"Handling Missing Data","description":"Learn how to handle missing data in PySpark DataFrames using drop, fill, and replace operations with practical Databricks examples.","keywords":["PySpark missing data","handle nulls in DataFrame","dropna PySpark","fillna DataFrame","replace null values","Databricks data cleaning"],"tags":["PySpark","Apache Spark","Big Data","Spark Basics","Cluster Computing","Spark Architecture","Driver Program","Executors","Cluster Manager","SparkSession","SparkContext","RDD","RDD Transformations","RDD Actions","Key-Value RDD","RDD Caching","DataFrame","DataFrame API","Column Operations","DataFrame Joins","Aggregations","GroupBy","Window Functions","Missing Data Handling","Spark SQL","Temp Views","Spark SQL Functions","UDF","UDAF"]}}');var i=n(4848),r=n(8453);const l={id:"df-missing-data",title:"Handling Missing Data \u2014 Drop, Fill & Replace",sidebar_label:"Handling Missing Data",description:"Learn how to handle missing data in PySpark DataFrames using drop, fill, and replace operations with practical Databricks examples.",keywords:["PySpark missing data","handle nulls in DataFrame","dropna PySpark","fillna DataFrame","replace null values","Databricks data cleaning"],tags:["PySpark","Apache Spark","Big Data","Spark Basics","Cluster Computing","Spark Architecture","Driver Program","Executors","Cluster Manager","SparkSession","SparkContext","RDD","RDD Transformations","RDD Actions","Key-Value RDD","RDD Caching","DataFrame","DataFrame API","Column Operations","DataFrame Joins","Aggregations","GroupBy","Window Functions","Missing Data Handling","Spark SQL","Temp Views","Spark SQL Functions","UDF","UDAF"]},t="Handling Missing Data \u2014 Drop, Fill & Replace",o={},p=[{value:"Why Handling Missing Data Matters",id:"why-handling-missing-data-matters",level:2},{value:"1. drop() / dropna() \u2014 Remove Rows with Nulls",id:"1-drop--dropna--remove-rows-with-nulls",level:2},{value:"Options:",id:"options",level:3},{value:"Story Example",id:"story-example",level:3},{value:"2. fill() / fillna() \u2014 Replace Nulls with a Value",id:"2-fill--fillna--replace-nulls-with-a-value",level:2},{value:"Use Cases:",id:"use-cases",level:3},{value:"Story Example",id:"story-example-1",level:3},{value:"3. replace() \u2014 Substitute Specific Values",id:"3-replace--substitute-specific-values",level:2},{value:"Use Cases:",id:"use-cases-1",level:3},{value:"Story Example",id:"story-example-2",level:3},{value:"4. Combining Methods",id:"4-combining-methods",level:2},{value:"Summary",id:"summary",level:2}];function d(e){const a={br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(a.header,{children:(0,i.jsx)(a.h1,{id:"handling-missing-data--drop-fill--replace",children:"Handling Missing Data \u2014 Drop, Fill & Replace"})}),"\n",(0,i.jsxs)(a.p,{children:["At ",(0,i.jsx)(a.strong,{children:"NeoMart"}),", real-world data is messy.",(0,i.jsx)(a.br,{}),"\n","Customer information may be incomplete, product prices may be missing, or logs may have null values.",(0,i.jsx)(a.br,{}),"\n","Before analysis, ",(0,i.jsx)(a.strong,{children:"cleaning missing data"})," is essential to avoid ",(0,i.jsx)(a.strong,{children:"incorrect insights"})," or ",(0,i.jsx)(a.strong,{children:"errors in ML models"}),"."]}),"\n",(0,i.jsxs)(a.p,{children:["PySpark provides ",(0,i.jsx)(a.strong,{children:"simple and powerful methods"})," to handle missing values at scale."]}),"\n",(0,i.jsx)(a.hr,{}),"\n",(0,i.jsx)(a.h2,{id:"why-handling-missing-data-matters",children:"Why Handling Missing Data Matters"}),"\n",(0,i.jsxs)(a.ul,{children:["\n",(0,i.jsx)(a.li,{children:"Null values can break transformations and aggregations"}),"\n",(0,i.jsxs)(a.li,{children:["Missing data affects ",(0,i.jsx)(a.strong,{children:"accuracy"})," in analytics and machine learning"]}),"\n",(0,i.jsxs)(a.li,{children:["Cleaning ensures ",(0,i.jsx)(a.strong,{children:"consistent, reliable datasets"})]}),"\n",(0,i.jsxs)(a.li,{children:["Helps optimize ",(0,i.jsx)(a.strong,{children:"storage and compute"})," in Databricks"]}),"\n"]}),"\n",(0,i.jsx)(a.hr,{}),"\n",(0,i.jsx)(a.h2,{id:"1-drop--dropna--remove-rows-with-nulls",children:"1. drop() / dropna() \u2014 Remove Rows with Nulls"}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-python",children:"df_clean = df.dropna()\n"})}),"\n",(0,i.jsx)(a.h3,{id:"options",children:"Options:"}),"\n",(0,i.jsxs)(a.ul,{children:["\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.code,{children:'how="any"'})," \u2192 drops row if ",(0,i.jsx)(a.strong,{children:"any column"})," is null (default)"]}),"\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.code,{children:'how="all"'})," \u2192 drops row only if ",(0,i.jsx)(a.strong,{children:"all columns"})," are null"]}),"\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.code,{children:'subset=["col1","col2"]'})," \u2192 drops row if null in specific columns"]}),"\n"]}),"\n",(0,i.jsx)(a.h3,{id:"story-example",children:"Story Example"}),"\n",(0,i.jsxs)(a.p,{children:["NeoMart wants to ",(0,i.jsx)(a.strong,{children:"remove transactions without an order amount"}),":"]}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-python",children:'orders_df.dropna(subset=["amount"]).show()\n'})}),"\n",(0,i.jsx)(a.p,{children:"This keeps only valid orders for reporting."}),"\n",(0,i.jsx)(a.hr,{}),"\n",(0,i.jsx)(a.h2,{id:"2-fill--fillna--replace-nulls-with-a-value",children:"2. fill() / fillna() \u2014 Replace Nulls with a Value"}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-python",children:'df_filled = df.fillna(0, subset=["amount"])\r\ndf_filled = df.fillna({"city": "Unknown", "quantity": 1})\n'})}),"\n",(0,i.jsx)(a.h3,{id:"use-cases",children:"Use Cases:"}),"\n",(0,i.jsxs)(a.ul,{children:["\n",(0,i.jsxs)(a.li,{children:["Replace missing numeric values with ",(0,i.jsx)(a.strong,{children:"0"})," or mean"]}),"\n",(0,i.jsxs)(a.li,{children:["Replace missing strings with ",(0,i.jsx)(a.strong,{children:"\u201cUnknown\u201d"})]}),"\n",(0,i.jsx)(a.li,{children:"Fill multiple columns with different values"}),"\n"]}),"\n",(0,i.jsx)(a.h3,{id:"story-example-1",children:"Story Example"}),"\n",(0,i.jsx)(a.p,{children:'NeoMart fills missing product categories with "Miscellaneous":'}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-python",children:'products_df.fillna({"category": "Miscellaneous"}).show()\n'})}),"\n",(0,i.jsx)(a.hr,{}),"\n",(0,i.jsx)(a.h2,{id:"3-replace--substitute-specific-values",children:"3. replace() \u2014 Substitute Specific Values"}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-python",children:'df.replace({"N/A": None, "NA": None}).show()\n'})}),"\n",(0,i.jsx)(a.h3,{id:"use-cases-1",children:"Use Cases:"}),"\n",(0,i.jsxs)(a.ul,{children:["\n",(0,i.jsxs)(a.li,{children:['Convert placeholder strings (like "N/A") to ',(0,i.jsx)(a.strong,{children:"null"})]}),"\n",(0,i.jsx)(a.li,{children:"Replace erroneous values with correct defaults"}),"\n"]}),"\n",(0,i.jsx)(a.h3,{id:"story-example-2",children:"Story Example"}),"\n",(0,i.jsx)(a.p,{children:"NeoMart replaces invalid age values in customer data:"}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-python",children:'customers_df.replace({"-1": None}).show()\n'})}),"\n",(0,i.jsx)(a.hr,{}),"\n",(0,i.jsx)(a.h2,{id:"4-combining-methods",children:"4. Combining Methods"}),"\n",(0,i.jsxs)(a.p,{children:["You can ",(0,i.jsx)(a.strong,{children:"chain operations"})," to clean data efficiently:"]}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-python",children:'clean_df = (\r\n    raw_df.replace({"N/A": None})\r\n          .fillna({"quantity": 1, "city": "Unknown"})\r\n          .dropna(subset=["amount", "product_id"])\r\n)\n'})}),"\n",(0,i.jsxs)(a.p,{children:["This ensures a fully ",(0,i.jsx)(a.strong,{children:"consistent and ready-to-use dataset"}),"."]}),"\n",(0,i.jsx)(a.hr,{}),"\n",(0,i.jsx)(a.h2,{id:"summary",children:"Summary"}),"\n",(0,i.jsxs)(a.ul,{children:["\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.strong,{children:"drop()/dropna()"})," \u2192 remove rows with nulls"]}),"\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.strong,{children:"fill()/fillna()"})," \u2192 replace nulls with default values"]}),"\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.strong,{children:"replace()"})," \u2192 substitute specific values"]}),"\n",(0,i.jsxs)(a.li,{children:["Proper handling of missing data ensures ",(0,i.jsx)(a.strong,{children:"accurate analytics"}),", ",(0,i.jsx)(a.strong,{children:"reliable ML models"}),", and ",(0,i.jsx)(a.strong,{children:"optimized Spark performance"})]}),"\n"]}),"\n",(0,i.jsx)(a.hr,{}),"\n",(0,i.jsxs)(a.p,{children:["Next, we\u2019ll cover ",(0,i.jsx)(a.strong,{children:"Using Spark SQL \u2014 Register Temp Views and Query"}),"."]})]})}function c(e={}){const{wrapper:a}={...(0,r.R)(),...e.components};return a?(0,i.jsx)(a,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,a,n)=>{n.d(a,{R:()=>l,x:()=>t});var s=n(6540);const i={},r=s.createContext(i);function l(e){const a=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(a):{...a,...e}},[a,e])}function t(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),s.createElement(r.Provider,{value:a},e.children)}}}]);