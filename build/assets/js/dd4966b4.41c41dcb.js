"use strict";(self.webpackChunkdatacraft_school=self.webpackChunkdatacraft_school||[]).push([[9468],{7005:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>c,contentTitle:()=>l,default:()=>a,frontMatter:()=>i,metadata:()=>d,toc:()=>h});const d=JSON.parse('{"id":"pyspark-one-liners","title":"One-Line PySpark Function Meanings","description":"\ud83e\uddf0 Basic utilities","source":"@site/docs-pyspark/pyspark-one-liners.md","sourceDirName":".","slug":"/pyspark-one-liners","permalink":"/pyspark/pyspark-one-liners","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"pyspark-one-liners","title":"One-Line PySpark Function Meanings","sidebar_label":"Function Meanings"}}');var n=t(4848),r=t(8453);const i={id:"pyspark-one-liners",title:"One-Line PySpark Function Meanings",sidebar_label:"Function Meanings"},l=void 0,c={},h=[{value:"\ud83e\uddf0 Basic utilities",id:"-basic-utilities",level:2},{value:"\ud83d\udce6Data Loading &amp; Preview",id:"data-loading--preview",level:2},{value:"\ud83d\udcc5Date Functions",id:"date-functions",level:2},{value:"\ud83e\uddee Aggregations &amp; Metrics",id:"-aggregations--metrics",level:2},{value:"\ud83e\uddee Column Math / Derived Columns",id:"-column-math--derived-columns",level:2},{value:"\ud83e\udde0 SQL Queries",id:"-sql-queries",level:2},{value:"\ud83e\uddf0\ud83e\udde0Utility &amp; Optimization Methods",id:"utility--optimization-methods",level:2},{value:"Joins",id:"joins",level:2}];function o(e){const s={code:"code",h2:"h2",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,r.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.h2,{id:"-basic-utilities",children:"\ud83e\uddf0 Basic utilities"}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:"Function / Method"}),(0,n.jsx)(s.th,{children:"Meaning"})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"from pyspark.sql.functions import ..."})}),(0,n.jsx)(s.td,{children:"Imports built-in functions from PySpark SQL module."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:".select([...])"})}),(0,n.jsx)(s.td,{children:"Selects specific columns from the DataFrame."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.code,{children:".show()"})," after any transformation"]}),(0,n.jsx)(s.td,{children:"Displays the result of the transformation for visual inspection."})]})]})]}),"\n",(0,n.jsx)(s.h2,{id:"data-loading--preview",children:"\ud83d\udce6Data Loading & Preview"}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:"Method / Parameter"}),(0,n.jsx)(s.th,{children:"Meaning"})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"inferSchema=True"})}),(0,n.jsx)(s.td,{children:"Automatically detects the data types of columns."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"header=True"})}),(0,n.jsx)(s.td,{children:"Treats the first row of the file as column headers."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"df.show()"})}),(0,n.jsx)(s.td,{children:"Displays the first 20 rows of the DataFrame."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"df.head(1)"})}),(0,n.jsx)(s.td,{children:"Retrieves the first row as a list of Row objects."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"df.printSchema()"})}),(0,n.jsx)(s.td,{children:"Displays the structure (schema) of the DataFrame."})]})]})]}),"\n",(0,n.jsx)(s.h2,{id:"date-functions",children:"\ud83d\udcc5Date Functions"}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:"Function / Method"}),(0,n.jsx)(s.th,{children:"Meaning"})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"dayofmonth(df['Date'])"})}),(0,n.jsx)(s.td,{children:"Extracts the day (1\u201331) from a date."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"month(df['Date'])"})}),(0,n.jsx)(s.td,{children:"Extracts the month (1\u201312) from a date."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"year(df['Date'])"})}),(0,n.jsx)(s.td,{children:"Extracts the year (e.g., 2023) from a date."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"weekofyear(df['Date'])"})}),(0,n.jsx)(s.td,{children:"Extracts the week number of the year from a date."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"date_format(df['Date'], 'MMM')"})}),(0,n.jsx)(s.td,{children:"Formats the date into a custom format (e.g., Jan, Feb)."})]})]})]}),"\n",(0,n.jsx)(s.h2,{id:"-aggregations--metrics",children:"\ud83e\uddee Aggregations & Metrics"}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:"Function / Method"}),(0,n.jsx)(s.th,{children:"Meaning"})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"withColumn('Year', year(df['Date']))"})}),(0,n.jsx)(s.td,{children:"Creates a new column 'Year' derived from the 'Date' column."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"groupBy('Year')"})}),(0,n.jsx)(s.td,{children:"Groups the rows by 'Year' column."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.code,{children:".mean()"})," or ",(0,n.jsx)(s.code,{children:".agg({'col':'mean'})"})]}),(0,n.jsx)(s.td,{children:"Computes average of one or more columns."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:".agg({'Sales':'sum'})"})}),(0,n.jsx)(s.td,{children:"Computes the total sum for the 'Sales' column."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:".agg({'Volume':'max'})"})}),(0,n.jsx)(s.td,{children:"Finds the maximum value in the 'Volume' column."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"round(mean(df['Close']), 2)"})}),(0,n.jsx)(s.td,{children:"Computes the mean and rounds it to 2 decimal places."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.code,{children:"max(df['Volume'])"}),", ",(0,n.jsx)(s.code,{children:"min(df['Volume'])"})]}),(0,n.jsx)(s.td,{children:"Gets maximum or minimum volume across all rows."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"countDistinct(df['Sales'])"})}),(0,n.jsx)(s.td,{children:"Counts unique (distinct) values in the 'Sales' column."})]})]})]}),"\n",(0,n.jsx)(s.h2,{id:"-column-math--derived-columns",children:"\ud83e\uddee Column Math / Derived Columns"}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:"Expression / Method"}),(0,n.jsx)(s.th,{children:"Meaning"})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"(df['ForecastUnits'] / df['ActualUnits'])"})}),(0,n.jsx)(s.td,{children:"Creates a new column with ratio of forecast to actual units."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:".alias('Forecast_to_Actual')"})}),(0,n.jsx)(s.td,{children:"Renames the resulting column to a readable name."})]})]})]}),"\n",(0,n.jsx)(s.h2,{id:"-sql-queries",children:"\ud83e\udde0 SQL Queries"}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:"Function / Method"}),(0,n.jsx)(s.th,{children:"Meaning"})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"createOrReplaceTempView('table')"})}),(0,n.jsx)(s.td,{children:"Registers DataFrame as a temporary SQL table."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"spark.sql('...')"})}),(0,n.jsx)(s.td,{children:"Executes SQL query on registered temp table."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"SELECT MAX(column) FROM table"})}),(0,n.jsx)(s.td,{children:"SQL syntax to find the maximum value in a column."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"WHERE ActualUnits = (SELECT MAX(ActualUnits)...)"})}),(0,n.jsx)(s.td,{children:"Filters rows that have the maximum actual units."})]})]})]}),"\n",(0,n.jsx)(s.h2,{id:"utility--optimization-methods",children:"\ud83e\uddf0\ud83e\udde0Utility & Optimization Methods"}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:"Function / Method"}),(0,n.jsx)(s.th,{children:"One-Line Meaning"})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"distinct()"})}),(0,n.jsx)(s.td,{children:"Removes duplicate rows from the DataFrame."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"dropDuplicates(['col1', 'col2'])"})}),(0,n.jsx)(s.td,{children:"Removes duplicate rows based on specific columns."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:'selectExpr("colA as newCol")'})}),(0,n.jsx)(s.td,{children:"Selects column(s) using SQL expressions with aliasing."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:'withColumnRenamed("old", "new")'})}),(0,n.jsx)(s.td,{children:"Renames a column."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"cache()"})}),(0,n.jsx)(s.td,{children:"Caches the DataFrame in memory for faster access."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"persist()"})}),(0,n.jsx)(s.td,{children:"Stores DataFrame with a specified storage level (memory, disk, etc.)."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"repartition(4)"})}),(0,n.jsx)(s.td,{children:"Redistributes rows across a specified number of partitions."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"coalesce(1)"})}),(0,n.jsx)(s.td,{children:"Reduces the number of partitions, often to write a single output file."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"dropna()"})}),(0,n.jsxs)(s.td,{children:["Drops rows with null values (alias for ",(0,n.jsx)(s.code,{children:"na.drop()"}),")."]})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"fillna(value)"})}),(0,n.jsx)(s.td,{children:"Fills null values with the specified value."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.code,{children:"isNull()"}),", ",(0,n.jsx)(s.code,{children:"isNotNull()"})]}),(0,n.jsx)(s.td,{children:"Filters rows with null or non-null values."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.code,{children:"when(...).otherwise(...)"})," (from ",(0,n.jsx)(s.code,{children:"functions"}),")"]}),(0,n.jsxs)(s.td,{children:["Performs conditional logic like SQL ",(0,n.jsx)(s.code,{children:"CASE WHEN"}),"."]})]})]})]}),"\n",(0,n.jsx)(s.h2,{id:"joins",children:"Joins"}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:"Join Type"}),(0,n.jsx)(s.th,{children:"Why We Need It"})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"inner"})}),(0,n.jsx)(s.td,{children:"Only matching rows (common records)"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"left"})}),(0,n.jsx)(s.td,{children:"Keep all from left, match where possible"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"right"})}),(0,n.jsx)(s.td,{children:"Keep all from right, match where possible"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"outer"})}),(0,n.jsx)(s.td,{children:"Keep everything from both sides"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"left_semi"})}),(0,n.jsx)(s.td,{children:"Filter left rows that exist in right"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"left_anti"})}),(0,n.jsxs)(s.td,{children:["Filter left rows that ",(0,n.jsx)(s.strong,{children:"don\u2019t"})," exist in right"]})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"crossJoin()"})}),(0,n.jsx)(s.td,{children:"All combinations (use cautiously \u2014 can explode rows)"})]})]})]})]})}function a(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(o,{...e})}):o(e)}},8453:(e,s,t)=>{t.d(s,{R:()=>i,x:()=>l});var d=t(6540);const n={},r=d.createContext(n);function i(e){const s=d.useContext(r);return d.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function l(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:i(e.components),d.createElement(r.Provider,{value:s},e.children)}}}]);