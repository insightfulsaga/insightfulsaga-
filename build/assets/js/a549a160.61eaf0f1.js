"use strict";(self.webpackChunkdatacraft_school=self.webpackChunkdatacraft_school||[]).push([[9084],{6710:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>i,contentTitle:()=>a,default:()=>x,frontMatter:()=>d,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"linear-regression-math","title":"Manual Linear Regression \u2014 Explained Step-by-Step","description":"Learn how to calculate slope and intercept manually using basic math and a lemonade example.","source":"@site/docs-pyspark/linear-regression-math.md","sourceDirName":".","slug":"/linear-regression-math","permalink":"/pyspark/linear-regression-math","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"linear-regression-math","title":"Manual Linear Regression \u2014 Explained Step-by-Step","sidebar_label":"Linear Regression (Manual Math)","description":"Learn how to calculate slope and intercept manually using basic math and a lemonade example."}}');var r=s(4848),l=s(8453);const d={id:"linear-regression-math",title:"Manual Linear Regression \u2014 Explained Step-by-Step",sidebar_label:"Linear Regression (Manual Math)",description:"Learn how to calculate slope and intercept manually using basic math and a lemonade example."},a="\ud83d\udcd0 Linear Regression \u2014 Manual Math Breakdown",i={},c=[{value:"\ud83c\udf4b Use Case: Lemonade Stand Sales",id:"-use-case-lemonade-stand-sales",level:2},{value:"\ud83d\udcd8 Step-by-Step Explanation of the Core Formulas",id:"-step-by-step-explanation-of-the-core-formulas",level:2},{value:"\ud83e\uddee Step 1: Calculate the Mean of x-values",id:"-step-1-calculate-the-mean-of-x-values",level:3},{value:"\ud83d\udcca Step 2: Calculate the Mean of y-values",id:"-step-2-calculate-the-mean-of-y-values",level:3},{value:"\ud83d\udcd0 Step 3: Compute the Slope (w)",id:"-step-3-compute-the-slope-w",level:3},{value:"\ud83d\udccf Step 4: Compute the Intercept (b)",id:"-step-4-compute-the-intercept-b",level:3},{value:"2\ufe0f\u20e3 Step-by-Step Calculation",id:"2\ufe0f\u20e3-step-by-step-calculation",level:2},{value:"Step 1: Calculate Means",id:"step-1-calculate-means",level:3},{value:"Step 2: Build Table",id:"step-2-build-table",level:3},{value:"Step 3: Calculate Coefficient &amp; Intercept",id:"step-3-calculate-coefficient--intercept",level:3},{value:"3\ufe0f\u20e3 Test the Manual Model",id:"3\ufe0f\u20e3-test-the-manual-model",level:2},{value:"\ud83d\udd01 PySpark Comparison",id:"-pyspark-comparison",level:2},{value:"\ud83d\udd11 1-Minute Summary \u2014 Manual Linear Regression (Lemonade Sales Example)",id:"-1-minute-summary--manual-linear-regression-lemonade-sales-example",level:2}];function h(e){const n={br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"-linear-regression--manual-math-breakdown",children:"\ud83d\udcd0 Linear Regression \u2014 Manual Math Breakdown"})}),"\n",(0,r.jsxs)(n.p,{children:["Let\u2019s calculate everything ",(0,r.jsx)(n.strong,{children:"manually"})," to understand how PySpark computes slope (",(0,r.jsx)(n.code,{children:"w"}),") and intercept (",(0,r.jsx)(n.code,{children:"b"}),")."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"-use-case-lemonade-stand-sales",children:"\ud83c\udf4b Use Case: Lemonade Stand Sales"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Temperature (x \xb0C)"}),(0,r.jsx)(n.th,{children:"Sales (y units)"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"20"}),(0,r.jsx)(n.td,{children:"30"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"25"}),(0,r.jsx)(n.td,{children:"50"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"30"}),(0,r.jsx)(n.td,{children:"70"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"35"}),(0,r.jsx)(n.td,{children:"90"})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"-step-by-step-explanation-of-the-core-formulas",children:"\ud83d\udcd8 Step-by-Step Explanation of the Core Formulas"}),"\n",(0,r.jsx)(n.p,{children:"We are trying to fit the equation:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-text",children:"y = w * x + b\n"})}),"\n",(0,r.jsx)(n.p,{children:"Where:"}),"\n",(0,r.jsxs)(n.p,{children:["w is the slope",(0,r.jsx)(n.br,{}),"\n","b is the intercept"]}),"\n",(0,r.jsx)(n.p,{children:"To compute this manually, here are the steps:"}),"\n",(0,r.jsx)(n.h3,{id:"-step-1-calculate-the-mean-of-x-values",children:"\ud83e\uddee Step 1: Calculate the Mean of x-values"}),"\n",(0,r.jsx)(n.p,{children:"To find the average (mean) of your input values:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-text",children:"x\u0304 = (x\u2081 + x\u2082 + x\u2083 + x\u2084) / 4\n"})}),"\n",(0,r.jsx)(n.p,{children:"This gives you the center point of all the x-values (like average temperature)."}),"\n",(0,r.jsx)(n.h3,{id:"-step-2-calculate-the-mean-of-y-values",children:"\ud83d\udcca Step 2: Calculate the Mean of y-values"}),"\n",(0,r.jsx)(n.p,{children:"Same idea for the target values:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-text",children:"y\u0304 = (y\u2081 + y\u2082 + y\u2083 + y\u2084) / 4\n"})}),"\n",(0,r.jsx)(n.p,{children:"This gives the average output (like average sales)."}),"\n",(0,r.jsx)(n.h3,{id:"-step-3-compute-the-slope-w",children:"\ud83d\udcd0 Step 3: Compute the Slope (w)"}),"\n",(0,r.jsx)(n.p,{children:"This formula tells you how much y changes for every 1-unit increase in x:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-text",children:"w = \u03a3(x\u1d62 \u2212 x\u0304)(y\u1d62 \u2212 y\u0304) / \u03a3(x\u1d62 \u2212 x\u0304)\xb2\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Breakdown:"}),(0,r.jsx)(n.br,{}),"\n","-Subtract the mean from each x and y value to get how far each point is from the average.",(0,r.jsx)(n.br,{}),"\n","-Multiply the differences (x\u1d62 \u2212 x\u0304) and (y\u1d62 \u2212 y\u0304) for each row.",(0,r.jsx)(n.br,{}),"\n","-Sum those products (this gives the numerator).",(0,r.jsx)(n.br,{}),"\n","-Then, square each (x\u1d62 \u2212 x\u0304), and sum them (this gives the denominator).",(0,r.jsx)(n.br,{}),"\n","-Divide numerator by denominator to get w (slope)."]}),"\n",(0,r.jsx)(n.h3,{id:"-step-4-compute-the-intercept-b",children:"\ud83d\udccf Step 4: Compute the Intercept (b)"}),"\n",(0,r.jsx)(n.p,{children:"Once you have the slope, plug into this formula:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-text",children:"b = y\u0304 \u2212 w * x\u0304\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Meaning:"}),(0,r.jsx)(n.br,{}),"\n",'The intercept is the predicted value of y when x = 0. It "shifts" the line up or down to fit the data.']}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\u2705 Final Output"})}),"\n",(0,r.jsx)(n.p,{children:"Put it all together:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-text",children:"y = w * x + b\n"})}),"\n",(0,r.jsx)(n.p,{children:"Now you have a model that can predict future values of y (like sales) from new values of x (like temperature)."}),"\n",(0,r.jsx)(n.h2,{id:"2\ufe0f\u20e3-step-by-step-calculation",children:"2\ufe0f\u20e3 Step-by-Step Calculation"}),"\n",(0,r.jsx)(n.h3,{id:"step-1-calculate-means",children:"Step 1: Calculate Means"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"x values"}),(0,r.jsx)(n.th,{children:"y values"})]})}),(0,r.jsx)(n.tbody,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"20, 25, 30, 35"}),(0,r.jsx)(n.td,{children:"30, 50, 70, 90"})]})})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-text",children:"x\u0304 = 27.5\r\ny\u0304 = 60\n"})}),"\n",(0,r.jsx)(n.h3,{id:"step-2-build-table",children:"Step 2: Build Table"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"x"}),(0,r.jsx)(n.th,{children:"y"}),(0,r.jsx)(n.th,{children:"x - x\u0304"}),(0,r.jsx)(n.th,{children:"y - y\u0304"}),(0,r.jsx)(n.th,{children:"(x\u2212x\u0304)(y\u2212y\u0304)"}),(0,r.jsx)(n.th,{children:"(x\u2212x\u0304)\xb2"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"20"}),(0,r.jsx)(n.td,{children:"30"}),(0,r.jsx)(n.td,{children:"-7.5"}),(0,r.jsx)(n.td,{children:"-30"}),(0,r.jsx)(n.td,{children:"225"}),(0,r.jsx)(n.td,{children:"56.25"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"25"}),(0,r.jsx)(n.td,{children:"50"}),(0,r.jsx)(n.td,{children:"-2.5"}),(0,r.jsx)(n.td,{children:"-10"}),(0,r.jsx)(n.td,{children:"25"}),(0,r.jsx)(n.td,{children:"6.25"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"30"}),(0,r.jsx)(n.td,{children:"70"}),(0,r.jsx)(n.td,{children:"2.5"}),(0,r.jsx)(n.td,{children:"10"}),(0,r.jsx)(n.td,{children:"25"}),(0,r.jsx)(n.td,{children:"6.25"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"35"}),(0,r.jsx)(n.td,{children:"90"}),(0,r.jsx)(n.td,{children:"7.5"}),(0,r.jsx)(n.td,{children:"30"}),(0,r.jsx)(n.td,{children:"225"}),(0,r.jsx)(n.td,{children:"56.25"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Totals"})}),(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"500"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"125"})})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"step-3-calculate-coefficient--intercept",children:"Step 3: Calculate Coefficient & Intercept"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-text",children:"w = 500 / 125 = 4.0\r\nb = 60 - (4.0 \xd7 27.5) = -50\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u2705 Final model: y = 4.0x - 50"}),"\n",(0,r.jsx)(n.h2,{id:"3\ufe0f\u20e3-test-the-manual-model",children:"3\ufe0f\u20e3 Test the Manual Model"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"x (\xb0C)"}),(0,r.jsx)(n.th,{children:"Predicted y = 4x - 50"}),(0,r.jsx)(n.th,{children:"Actual y"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"20"}),(0,r.jsx)(n.td,{children:"30"}),(0,r.jsx)(n.td,{children:"30 \u2705"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"25"}),(0,r.jsx)(n.td,{children:"50"}),(0,r.jsx)(n.td,{children:"50 \u2705"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"30"}),(0,r.jsx)(n.td,{children:"70"}),(0,r.jsx)(n.td,{children:"70 \u2705"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"35"}),(0,r.jsx)(n.td,{children:"90"}),(0,r.jsx)(n.td,{children:"90 \u2705"})]})]})]}),"\n",(0,r.jsx)(n.p,{children:"\ud83c\udfaf Perfect fit!"}),"\n",(0,r.jsx)(n.h2,{id:"-pyspark-comparison",children:"\ud83d\udd01 PySpark Comparison"}),"\n",(0,r.jsx)(n.p,{children:"Here\u2019s how the exact same model looks using PySpark:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'from pyspark.ml.regression import LinearRegression\r\nfrom pyspark.ml.feature import VectorAssembler\r\n\r\ndata = [(20, 30), (25, 50), (30, 70), (35, 90)]\r\ndf = spark.createDataFrame(data, ["temperature", "sales"])\r\n\r\nassembler = VectorAssembler(inputCols=["temperature"], outputCol="features")\r\ndf_features = assembler.transform(df).select("features", "sales")\r\n\r\nlr = LinearRegression(featuresCol="features", labelCol="sales")\r\nmodel = lr.fit(df_features)\r\n\r\nprint("Coefficient:", model.coefficients)\r\nprint("Intercept:", model.intercept)\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Result"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-text",children:"Coefficient: [4.0]\r\nIntercept: -50.0\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u2705 Matches the manual result exactly."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\ud83c\udf93 Why Learn This?"})}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Reason"}),(0,r.jsx)(n.th,{children:"Benefit"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Build intuition"}),(0,r.jsxs)(n.td,{children:["Understand what slope and intercept ",(0,r.jsx)(n.strong,{children:"really mean"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Debugging skills"}),(0,r.jsx)(n.td,{children:"Check if your ML models are making sense"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"ML foundation"}),(0,r.jsx)(n.td,{children:"You'll understand more complex models better later"})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"-1-minute-summary--manual-linear-regression-lemonade-sales-example",children:"\ud83d\udd11 1-Minute Summary \u2014 Manual Linear Regression (Lemonade Sales Example)"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:(0,r.jsx)(n.strong,{children:"Step"})}),(0,r.jsx)(n.th,{children:(0,r.jsx)(n.strong,{children:"What You Did"})})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:["\ud83d\udcca ",(0,r.jsx)(n.strong,{children:"Raw Data"})]}),(0,r.jsx)(n.td,{children:"Temperature and sales from a lemonade stall"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:["\ud83e\uddee ",(0,r.jsx)(n.strong,{children:"Goal"})]}),(0,r.jsxs)(n.td,{children:["Fit a line ",(0,r.jsx)(n.code,{children:"y = w*x + b"})," to predict sales from temperature"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:["\ud83d\udccc ",(0,r.jsx)(n.strong,{children:"Formulas Used"})]}),(0,r.jsxs)(n.td,{children:["Slope: ",(0,r.jsx)(n.code,{children:"w = \u03a3(x_i - x\u0304)(y_i - \u0233) / \u03a3(x_i - x\u0304)\xb2"})," ",(0,r.jsx)("br",{})," Intercept: ",(0,r.jsx)(n.code,{children:"b = \u0233 - w*x\u0304"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:["\ud83d\udcc8 ",(0,r.jsx)(n.strong,{children:"Mean Values"})]}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"x\u0304 = 27.5"}),", ",(0,r.jsx)(n.code,{children:"\u0233 = 60"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:["\u270d\ufe0f ",(0,r.jsx)(n.strong,{children:"Computed Table"})]}),(0,r.jsxs)(n.td,{children:["Calculated ",(0,r.jsx)(n.code,{children:"(x - x\u0304)(y - \u0233)"})," and ",(0,r.jsx)(n.code,{children:"(x - x\u0304)\xb2"})," for all data points"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:["\u2795 ",(0,r.jsx)(n.strong,{children:"Sum of Products"})]}),(0,r.jsxs)(n.td,{children:["Numerator = ",(0,r.jsx)(n.code,{children:"500"}),", Denominator = ",(0,r.jsx)(n.code,{children:"125"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:["\ud83d\udcd0 ",(0,r.jsx)(n.strong,{children:"Slope (w)"})]}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"w = 500 / 125 = 4.0"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:["\ud83e\uddfe ",(0,r.jsx)(n.strong,{children:"Intercept (b)"})]}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"b = 60 - (4.0 * 27.5) = -50"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:["\u2705 ",(0,r.jsx)(n.strong,{children:"Final Equation"})]}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"y = 4.0x - 50"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:["\ud83d\udd2e ",(0,r.jsx)(n.strong,{children:"Manual Predictions"})]}),(0,r.jsx)(n.td,{children:"All predicted values match actual ones perfectly"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:["\ud83d\udd01 ",(0,r.jsx)(n.strong,{children:"Compared with PySpark"})]}),(0,r.jsxs)(n.td,{children:["PySpark model gave same result: Coefficient = ",(0,r.jsx)(n.code,{children:"4.0"}),", Intercept = ",(0,r.jsx)(n.code,{children:"-50.0"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:["\ud83e\udde0 ",(0,r.jsx)(n.strong,{children:"Why This Matters"})]}),(0,r.jsx)(n.td,{children:"Builds intuition, helps interpret model meaning, and validates ML results"})]})]})]})]})}function x(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>d,x:()=>a});var t=s(6540);const r={},l=t.createContext(r);function d(e){const n=t.useContext(l);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:d(e.components),t.createElement(l.Provider,{value:n},e.children)}}}]);