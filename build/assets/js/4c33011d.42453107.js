"use strict";(self.webpackChunkdatacraft_school=self.webpackChunkdatacraft_school||[]).push([[9252],{7832:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>t,contentTitle:()=>c,default:()=>o,frontMatter:()=>l,metadata:()=>a,toc:()=>h});const a=JSON.parse('{"id":"snowflake-caching","title":"Result Caching, Metadata Caching & Warehouse Caching","description":"A story-driven guide to understanding Snowflake caching layers: result cache, metadata cache, and warehouse cache, with practical examples and performance tips.","source":"@site/docs-snowflake/snowflake-caching.md","sourceDirName":".","slug":"/snowflake-caching","permalink":"/snowflake/snowflake-caching","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"snowflake-caching","title":"Result Caching, Metadata Caching & Warehouse Caching","sidebar_label":"Snowflake Caching","description":"A story-driven guide to understanding Snowflake caching layers: result cache, metadata cache, and warehouse cache, with practical examples and performance tips.","keywords":["Snowflake caching","Snowflake result cache","metadata cache Snowflake","warehouse cache Snowflake","Snowflake performance optimization","Snowflake query acceleration"]},"sidebar":"tutorialSidebar1","previous":{"title":"Query Profile Explained","permalink":"/snowflake/snowflake-query-profile"},"next":{"title":"Performance Tuning","permalink":"/snowflake/snowflake-performance-tuning"}}');var r=s(4848),i=s(8453);const l={id:"snowflake-caching",title:"Result Caching, Metadata Caching & Warehouse Caching",sidebar_label:"Snowflake Caching",description:"A story-driven guide to understanding Snowflake caching layers: result cache, metadata cache, and warehouse cache, with practical examples and performance tips.",keywords:["Snowflake caching","Snowflake result cache","metadata cache Snowflake","warehouse cache Snowflake","Snowflake performance optimization","Snowflake query acceleration"]},c="Result Caching, Metadata Caching & Warehouse Caching",t={},h=[{value:"\u2728 Story Time \u2014 \u201cWhy Is the Query Suddenly So Fast?\u201d",id:"-story-time--why-is-the-query-suddenly-so-fast",level:2},{value:"1\ufe0f\u20e3 Result Cache \u2014 Lightning-Fast Query Results",id:"1\ufe0f\u20e3-result-cache--lightning-fast-query-results",level:2},{value:"Example:",id:"example",level:3},{value:"2\ufe0f\u20e3 Metadata Cache \u2014 Smart Catalog Speed",id:"2\ufe0f\u20e3-metadata-cache--smart-catalog-speed",level:2},{value:"Purpose:",id:"purpose",level:3},{value:"Example:",id:"example-1",level:3},{value:"3\ufe0f\u20e3 Warehouse Cache (Local SSD / SSD Cache)",id:"3\ufe0f\u20e3-warehouse-cache-local-ssd--ssd-cache",level:2},{value:"Behavior:",id:"behavior",level:3},{value:"Example:",id:"example-2",level:3},{value:"\ud83d\udd04 How These Caches Work Together",id:"-how-these-caches-work-together",level:2},{value:"\ud83e\uddea Real-World Story \u2014 Ravi\u2019s Dashboard",id:"-real-world-story--ravis-dashboard",level:2},{value:"\ud83d\udca1 Practical Tips to Leverage Caching",id:"-practical-tips-to-leverage-caching",level:2},{value:"\u2705 Result Cache",id:"-result-cache",level:3},{value:"\u2705 Metadata Cache",id:"-metadata-cache",level:3},{value:"\u2705 Warehouse Cache",id:"-warehouse-cache",level:3},{value:"\u26a0\ufe0f Common Misconceptions",id:"\ufe0f-common-misconceptions",level:2},{value:"\ud83d\udcd8 Summary",id:"-summary",level:2}];function d(e){const n={blockquote:"blockquote",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"result-caching-metadata-caching--warehouse-caching",children:"Result Caching, Metadata Caching & Warehouse Caching"})}),"\n",(0,r.jsx)(n.h2,{id:"-story-time--why-is-the-query-suddenly-so-fast",children:"\u2728 Story Time \u2014 \u201cWhy Is the Query Suddenly So Fast?\u201d"}),"\n",(0,r.jsxs)(n.p,{children:["Meet Ravi, a BI engineer. Yesterday, his dashboard queries were taking ",(0,r.jsx)(n.strong,{children:"10 seconds"}),", but today:"]}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"\u201cWait\u2026 why is it only 0.5 seconds now?\u201d"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["No changes in SQL, no new indexes.",(0,r.jsx)(n.br,{}),"\n","The reason? ",(0,r.jsx)(n.strong,{children:"Snowflake caching magic."})]}),"\n",(0,r.jsxs)(n.p,{children:["Snowflake has ",(0,r.jsx)(n.strong,{children:"three types of caching"}),":"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Result Cache"}),"\n",(0,r.jsx)(n.li,{children:"Metadata Cache"}),"\n",(0,r.jsx)(n.li,{children:"Warehouse (Local Disk / SSD) Cache"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Let\u2019s explore each one and how it works."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"1\ufe0f\u20e3-result-cache--lightning-fast-query-results",children:"1\ufe0f\u20e3 Result Cache \u2014 Lightning-Fast Query Results"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Stores ",(0,r.jsx)(n.strong,{children:"query results"})," for ",(0,r.jsx)(n.strong,{children:"24 hours"})]}),"\n",(0,r.jsxs)(n.li,{children:["Applies ",(0,r.jsx)(n.strong,{children:"at the account level"})]}),"\n",(0,r.jsxs)(n.li,{children:["Used when the ",(0,r.jsx)(n.strong,{children:"same exact query"})," is run again"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"example",children:"Example:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"SELECT COUNT(*) \r\nFROM SALES \r\nWHERE REGION = 'Europe';\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"First run: scans 10GB \u2192 takes 8 seconds"}),"\n",(0,r.jsxs)(n.li,{children:["Second run: uses ",(0,r.jsx)(n.strong,{children:"result cache"})," \u2192 returns instantly (less than 0.01s)"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["\u2705 ",(0,r.jsx)(n.strong,{children:"Key points"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Query must be identical"}),"\n",(0,r.jsx)(n.li,{children:"Query on the same data"}),"\n",(0,r.jsx)(n.li,{children:"No DML changes on underlying tables"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"2\ufe0f\u20e3-metadata-cache--smart-catalog-speed",children:"2\ufe0f\u20e3 Metadata Cache \u2014 Smart Catalog Speed"}),"\n",(0,r.jsx)(n.p,{children:"Metadata cache stores:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Table definitions"}),"\n",(0,r.jsx)(n.li,{children:"Column types"}),"\n",(0,r.jsx)(n.li,{children:"Micro-partition statistics"}),"\n",(0,r.jsx)(n.li,{children:"Min/Max values"}),"\n",(0,r.jsx)(n.li,{children:"Table size"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"purpose",children:"Purpose:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Accelerates ",(0,r.jsx)(n.strong,{children:"query compilation"})]}),"\n",(0,r.jsxs)(n.li,{children:["Reduces time spent reading ",(0,r.jsx)(n.strong,{children:"table metadata"})]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"example-1",children:"Example:"}),"\n",(0,r.jsx)(n.p,{children:"Query:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"SELECT * \r\nFROM ORDERS \r\nWHERE CUSTOMER_ID = 12345;\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Snowflake first checks ",(0,r.jsx)(n.strong,{children:"metadata cache"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Min/Max per micro-partition"}),"\n",(0,r.jsx)(n.li,{children:"Prunes irrelevant partitions"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"\u2705 Result: fewer partitions read \u2192 faster query."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"3\ufe0f\u20e3-warehouse-cache-local-ssd--ssd-cache",children:"3\ufe0f\u20e3 Warehouse Cache (Local SSD / SSD Cache)"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Caches ",(0,r.jsx)(n.strong,{children:"recently accessed micro-partitions"})," on the warehouse level"]}),"\n",(0,r.jsxs)(n.li,{children:["Applies to ",(0,r.jsx)(n.strong,{children:"intermediate results"})]}),"\n",(0,r.jsx)(n.li,{children:"Faster than reading from cloud storage (S3/Azure Blob/GCS)"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"behavior",children:"Behavior:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Cache is ",(0,r.jsx)(n.strong,{children:"per warehouse"})]}),"\n",(0,r.jsx)(n.li,{children:"If you resize warehouse \u2192 cache cleared"}),"\n",(0,r.jsx)(n.li,{children:"Active queries benefit more"}),"\n",(0,r.jsxs)(n.li,{children:["Improves ",(0,r.jsx)(n.strong,{children:"large table scans"})," and repeated transformations"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"example-2",children:"Example:"}),"\n",(0,r.jsx)(n.p,{children:"Transforming SALES table:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"SELECT CUSTOMER_ID, SUM(AMOUNT)\r\nFROM SALES\r\nGROUP BY CUSTOMER_ID;\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"First run: reads from cloud \u2192 12 seconds"}),"\n",(0,r.jsx)(n.li,{children:"Second run (same warehouse, same table): warehouse cache \u2192 4 seconds"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"-how-these-caches-work-together",children:"\ud83d\udd04 How These Caches Work Together"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Cache Type"}),(0,r.jsx)(n.th,{children:"Scope"}),(0,r.jsx)(n.th,{children:"Lifetime"}),(0,r.jsx)(n.th,{children:"Notes"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Result Cache"}),(0,r.jsx)(n.td,{children:"Account"}),(0,r.jsx)(n.td,{children:"24 hours"}),(0,r.jsx)(n.td,{children:"Query-level, identical queries only"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Metadata Cache"}),(0,r.jsx)(n.td,{children:"Warehouse + global"}),(0,r.jsx)(n.td,{children:"Until invalidated"}),(0,r.jsx)(n.td,{children:"Auto-prunes partitions, speeds compilation"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Warehouse Cache"}),(0,r.jsx)(n.td,{children:"Warehouse"}),(0,r.jsx)(n.td,{children:"Session-based"}),(0,r.jsx)(n.td,{children:"Intermediate data + table blocks, faster scans"})]})]})]}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"Snowflake automatically chooses which cache to use based on query, table, and warehouse state."}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"-real-world-story--ravis-dashboard",children:"\ud83e\uddea Real-World Story \u2014 Ravi\u2019s Dashboard"}),"\n",(0,r.jsx)(n.p,{children:"Ravi noticed:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Query A ran first at ",(0,r.jsx)(n.strong,{children:"10s"})," \u2192 result cached \u2192 ",(0,r.jsx)(n.strong,{children:"0.01s next run"})]}),"\n",(0,r.jsxs)(n.li,{children:["Query B scanned ",(0,r.jsx)(n.strong,{children:"large table"})," \u2192 warehouse cache reduced runtime by ",(0,r.jsx)(n.strong,{children:"3\xd7"})]}),"\n",(0,r.jsx)(n.li,{children:"Metadata cache prevented unnecessary compilation for 50+ queries"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Lesson:"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"\u201cCaching isn\u2019t magic \u2014 it\u2019s automatic, and it works best when queries are repeated.\u201d"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"-practical-tips-to-leverage-caching",children:"\ud83d\udca1 Practical Tips to Leverage Caching"}),"\n",(0,r.jsx)(n.h3,{id:"-result-cache",children:"\u2705 Result Cache"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Useful for dashboards or repeated queries"}),"\n",(0,r.jsx)(n.li,{children:"Avoid DML between runs if you want speed"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"-metadata-cache",children:"\u2705 Metadata Cache"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Automatically maintained"}),"\n",(0,r.jsx)(n.li,{children:"Design queries to benefit from partition pruning"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"-warehouse-cache",children:"\u2705 Warehouse Cache"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Keep the same warehouse active for repeated jobs"}),"\n",(0,r.jsx)(n.li,{children:"Avoid unnecessary resize operations"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"\ufe0f-common-misconceptions",children:"\u26a0\ufe0f Common Misconceptions"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u201cI need to enable caching manually.\u201d"})," \u2192 \u274c False, Snowflake caches automatically."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u201cCaching increases storage cost.\u201d"})," \u2192 \u274c False, cached data is ephemeral and included in warehouse usage."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u201cAll queries benefit equally.\u201d"})," \u2192 \u274c Only repeated queries, same warehouse, or unchanged tables benefit."]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"-summary",children:"\ud83d\udcd8 Summary"}),"\n",(0,r.jsxs)(n.p,{children:["Snowflake caching layers are key for ",(0,r.jsx)(n.strong,{children:"high performance without manual tuning"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Result Cache:"})," Instant query returns for identical queries"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Metadata Cache:"})," Speeds query compilation and pruning"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Warehouse Cache:"})," Reduces repeated large table scans"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"When used properly, caching dramatically improves:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"BI dashboard response time"}),"\n",(0,r.jsx)(n.li,{children:"ETL pipeline efficiency"}),"\n",(0,r.jsx)(n.li,{children:"Daily analytical workloads"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["Snowflake handles caching automatically \u2014 your job is to ",(0,r.jsx)(n.strong,{children:"design queries and workloads that benefit from it"}),"."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h1,{id:"-next-topic",children:"\ud83d\udc49 Next Topic"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Performance Tuning Techniques for Daily Company Work"})})]})}function o(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>c});var a=s(6540);const r={},i=a.createContext(r);function l(e){const n=a.useContext(i);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),a.createElement(i.Provider,{value:n},e.children)}}}]);