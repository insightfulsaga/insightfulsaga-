"use strict";(self.webpackChunkdatacraft_school=self.webpackChunkdatacraft_school||[]).push([[4406],{2593:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>i,default:()=>x,frontMatter:()=>t,metadata:()=>l,toc:()=>c});const l=JSON.parse('{"id":"snowflake-external-stages","title":"External Stages (S3, Azure, GCS) \u2014 Real Company Setup Example","description":"Beginner-friendly, story-driven guide to Snowflake external stages, including S3, Azure Blob, and Google Cloud Storage setup with real-world examples.","source":"@site/docs-snowflake/snowflake-external-stages.md","sourceDirName":".","slug":"/snowflake-external-stages","permalink":"/snowflake/snowflake-external-stages","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"snowflake-external-stages","title":"External Stages (S3, Azure, GCS) \u2014 Real Company Setup Example","sidebar_label":"External Stages","description":"Beginner-friendly, story-driven guide to Snowflake external stages, including S3, Azure Blob, and Google Cloud Storage setup with real-world examples.","keywords":["Snowflake external stage","Snowflake S3 stage","Snowflake Azure stage","Snowflake GCS stage","Snowflake cloud storage"]},"sidebar":"tutorialSidebar1","previous":{"title":"Snowflake Stages","permalink":"/snowflake/snowflake-internal-table-user-stages"},"next":{"title":"File Formats","permalink":"/snowflake/snowflake-file-formats"}}');var r=s(4848),a=s(8453);const t={id:"snowflake-external-stages",title:"External Stages (S3, Azure, GCS) \u2014 Real Company Setup Example",sidebar_label:"External Stages",description:"Beginner-friendly, story-driven guide to Snowflake external stages, including S3, Azure Blob, and Google Cloud Storage setup with real-world examples.",keywords:["Snowflake external stage","Snowflake S3 stage","Snowflake Azure stage","Snowflake GCS stage","Snowflake cloud storage"]},i="External Stages (S3, Azure, GCS) \u2014 Real Company Setup Example",o={},c=[{value:"\ud83c\udfd7\ufe0f What Are External Stages?",id:"\ufe0f-what-are-external-stages",level:2},{value:"\ud83d\udd39 1\ufe0f\u20e3 Setting Up an S3 External Stage",id:"-1\ufe0f\u20e3-setting-up-an-s3-external-stage",level:2},{value:"\ud83d\udd39 2\ufe0f\u20e3 Azure Blob Storage Example",id:"-2\ufe0f\u20e3-azure-blob-storage-example",level:2},{value:"\ud83d\udd39 3\ufe0f\u20e3 Google Cloud Storage (GCS) Example",id:"-3\ufe0f\u20e3-google-cloud-storage-gcs-example",level:2},{value:"\ud83e\udde0 Best Practices for External Stages",id:"-best-practices-for-external-stages",level:2},{value:"\ud83e\udde9 Story Recap \u2014 RetailCo External Stages in Action",id:"-story-recap--retailco-external-stages-in-action",level:2},{value:"\ud83c\udfc1 Quick Summary",id:"-quick-summary",level:2}];function d(e){const n={blockquote:"blockquote",br:"br",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"external-stages-s3-azure-gcs--real-company-setup-example",children:"External Stages (S3, Azure, GCS) \u2014 Real Company Setup Example"})}),"\n",(0,r.jsxs)(n.p,{children:["Welcome back to ",(0,r.jsx)(n.strong,{children:"RetailCo"}),", our fictional retail company.",(0,r.jsx)(n.br,{}),"\n","Alice, the data engineer, now wants to ",(0,r.jsx)(n.strong,{children:"load large amounts of historical sales data stored in AWS S3"})," into Snowflake."]}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["\u201cInternal stages are great for small loads,\u201d she explains, \u201cbut for large datasets or multi-team projects, we use ",(0,r.jsx)(n.strong,{children:"external stages"}),".\u201d"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["Let\u2019s explore ",(0,r.jsx)(n.strong,{children:"Snowflake external stages"})," and see how RetailCo sets them up."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"\ufe0f-what-are-external-stages",children:"\ud83c\udfd7\ufe0f What Are External Stages?"}),"\n",(0,r.jsxs)(n.p,{children:["An ",(0,r.jsx)(n.strong,{children:"external stage"})," is a reference to a ",(0,r.jsx)(n.strong,{children:"cloud storage location outside Snowflake"}),", such as:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"AWS S3"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"Azure Blob Storage"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"Google Cloud Storage (GCS)"})}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Benefits:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Handle ",(0,r.jsx)(n.strong,{children:"large datasets"})," efficiently"]}),"\n",(0,r.jsx)(n.li,{children:"Share data between multiple Snowflake accounts"}),"\n",(0,r.jsxs)(n.li,{children:["Integrate with ",(0,r.jsx)(n.strong,{children:"data lakes or pipelines"})]}),"\n",(0,r.jsx)(n.li,{children:"Secure access with cloud credentials"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"RetailCo example:"})," Historical sales CSVs and JSON files sit in an S3 bucket. Alice wants to stage them in Snowflake without copying them internally."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"-1\ufe0f\u20e3-setting-up-an-s3-external-stage",children:"\ud83d\udd39 1\ufe0f\u20e3 Setting Up an S3 External Stage"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Step 1: Create an S3 bucket"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Bucket name: ",(0,r.jsx)(n.code,{children:"retailco-sales-data"})]}),"\n",(0,r.jsxs)(n.li,{children:["Folders: ",(0,r.jsx)(n.code,{children:"/raw"}),", ",(0,r.jsx)(n.code,{children:"/processed"})]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Step 2: Create IAM user for Snowflake"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Permissions: ",(0,r.jsx)(n.code,{children:"s3:GetObject"}),", ",(0,r.jsx)(n.code,{children:"s3:ListBucket"})]}),"\n",(0,r.jsx)(n.li,{children:"Access key & secret key stored securely"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Step 3: Create Snowflake stage"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"CREATE STAGE S3_SALES_STAGE\r\n  URL='s3://retailco-sales-data/raw/'\r\n  CREDENTIALS=(\r\n    AWS_KEY_ID='YOUR_AWS_KEY'\r\n    AWS_SECRET_KEY='YOUR_AWS_SECRET'\r\n  )\r\n  FILE_FORMAT=(TYPE=CSV FIELD_OPTIONALLY_ENCLOSED_BY='\"' SKIP_HEADER=1);\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Step 4: Load data into Snowflake table"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"COPY INTO SALES\r\nFROM @S3_SALES_STAGE\r\nON_ERROR='CONTINUE';\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Result: Large CSVs are loaded directly from S3 into the ",(0,r.jsx)(n.code,{children:"SALES"})," table without storing them in Snowflake permanently first."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"-2\ufe0f\u20e3-azure-blob-storage-example",children:"\ud83d\udd39 2\ufe0f\u20e3 Azure Blob Storage Example"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"RetailCo has customer data in Azure Blob Storage."})," Steps:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"CREATE STAGE AZURE_CUSTOMERS_STAGE\r\n  URL='azure://retailco.blob.core.windows.net/raw/customers/'\r\n  CREDENTIALS=(AZURE_SAS_TOKEN='YOUR_SAS_TOKEN')\r\n  FILE_FORMAT=(TYPE=PARQUET);\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Parquet files loaded efficiently"}),"\n",(0,r.jsx)(n.li,{children:"Supports incremental updates with COPY INTO"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"COPY INTO CUSTOMERS FROM @AZURE_CUSTOMERS_STAGE;\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"-3\ufe0f\u20e3-google-cloud-storage-gcs-example",children:"\ud83d\udd39 3\ufe0f\u20e3 Google Cloud Storage (GCS) Example"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"RetailCo also uses GCS for analytics data."})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"CREATE STAGE GCS_ANALYTICS_STAGE\r\n  URL='gcs://retailco-analytics/raw/'\r\n  CREDENTIALS=(GCP_KEY='YOUR_GCP_KEY_JSON')\r\n  FILE_FORMAT=(TYPE=JSON);\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Load JSON logs directly into Snowflake tables"}),"\n",(0,r.jsx)(n.li,{children:"Ideal for multi-cloud environments"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"COPY INTO ANALYTICS_LOGS FROM @GCS_ANALYTICS_STAGE;\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"-best-practices-for-external-stages",children:"\ud83e\udde0 Best Practices for External Stages"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Use ",(0,r.jsx)(n.strong,{children:"dedicated cloud storage buckets"})," per project or team"]}),"\n",(0,r.jsxs)(n.li,{children:["Set ",(0,r.jsx)(n.strong,{children:"least privilege permissions"})," for credentials"]}),"\n",(0,r.jsxs)(n.li,{children:["Use ",(0,r.jsx)(n.strong,{children:"file formats matching your data"})," (CSV, JSON, Parquet)"]}),"\n",(0,r.jsxs)(n.li,{children:["Monitor ",(0,r.jsx)(n.strong,{children:"cloud storage costs"})," when staging large datasets"]}),"\n",(0,r.jsx)(n.li,{children:"Clean up or archive files after loading if possible"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"RetailCo Tip:"})," Store raw files in ",(0,r.jsx)(n.code,{children:"/raw"})," and processed files in ",(0,r.jsx)(n.code,{children:"/processed"})," folders to avoid overwriting important data."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"-story-recap--retailco-external-stages-in-action",children:"\ud83e\udde9 Story Recap \u2014 RetailCo External Stages in Action"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Alice creates ",(0,r.jsx)(n.strong,{children:"S3, Azure, and GCS stages"})," for different datasets"]}),"\n",(0,r.jsx)(n.li,{children:"ETL jobs COPY INTO Snowflake tables from external stages"}),"\n",(0,r.jsx)(n.li,{children:"Teams across RetailCo access raw and processed data without creating multiple copies"}),"\n",(0,r.jsx)(n.li,{children:"Data remains secure via cloud credentials and Snowflake RBAC"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["Result: ",(0,r.jsx)(n.strong,{children:"Efficient, scalable, and secure data loading from external cloud storage"}),"."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"-quick-summary",children:"\ud83c\udfc1 Quick Summary"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"External stages"})," allow Snowflake to read files directly from S3, Azure, or GCS"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Benefits:"})," scalability, multi-team collaboration, cloud integration"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Setup:"})," create stage, provide credentials, specify file format, and load data using COPY INTO"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Best practices:"})," organize buckets, secure credentials, monitor costs, and clean up after load"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h1,{id:"-coming-next",children:"\ud83d\ude80 Coming Next"}),"\n",(0,r.jsxs)(n.p,{children:["\ud83d\udc49 ",(0,r.jsx)(n.strong,{children:"File Formats (CSV, JSON, Parquet) \u2014 With Story and Use Cases"})]})]})}function x(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>i});var l=s(6540);const r={},a=l.createContext(r);function t(e){const n=l.useContext(a);return l.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),l.createElement(a.Provider,{value:n},e.children)}}}]);