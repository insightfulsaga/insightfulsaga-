"use strict";(self.webpackChunkdatacraft_school=self.webpackChunkdatacraft_school||[]).push([[9148],{2848:(e,n,l)=>{l.r(n),l.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>s,toc:()=>t});const s=JSON.parse('{"id":"snowflake-copy-into-command","title":"COPY INTO Command \u2014 Complete Guide with All Options","description":"Beginner-friendly, story-driven guide to Snowflake COPY INTO command, explaining all options, file formats, and real-world use cases.","source":"@site/docs-snowflake/snowflake-copy-into-command.md","sourceDirName":".","slug":"/snowflake-copy-into-command","permalink":"/snowflake/snowflake-copy-into-command","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"snowflake-copy-into-command","title":"COPY INTO Command \u2014 Complete Guide with All Options","sidebar_label":"COPY INTO Command","description":"Beginner-friendly, story-driven guide to Snowflake COPY INTO command, explaining all options, file formats, and real-world use cases.","keywords":["Snowflake COPY INTO","Snowflake data loading","Snowflake ETL","Snowflake load command","Snowflake staging"]},"sidebar":"tutorialSidebar1","previous":{"title":"File Formats","permalink":"/snowflake/snowflake-file-formats"},"next":{"title":"Snowpipe","permalink":"/snowflake/snowflake-snowpipe"}}');var i=l(4848),r=l(8453);const a={id:"snowflake-copy-into-command",title:"COPY INTO Command \u2014 Complete Guide with All Options",sidebar_label:"COPY INTO Command",description:"Beginner-friendly, story-driven guide to Snowflake COPY INTO command, explaining all options, file formats, and real-world use cases.",keywords:["Snowflake COPY INTO","Snowflake data loading","Snowflake ETL","Snowflake load command","Snowflake staging"]},o="COPY INTO Command \u2014 Complete Guide with All Options",d={},t=[{value:"\ud83c\udfd7\ufe0f What Is COPY INTO?",id:"\ufe0f-what-is-copy-into",level:2},{value:"\ud83d\udd39 Key Options",id:"-key-options",level:2},{value:"1\ufe0f\u20e3 FILE_FORMAT",id:"1\ufe0f\u20e3-file_format",level:3},{value:"2\ufe0f\u20e3 ON_ERROR",id:"2\ufe0f\u20e3-on_error",level:3},{value:"3\ufe0f\u20e3 PATTERN",id:"3\ufe0f\u20e3-pattern",level:3},{value:"4\ufe0f\u20e3 FORCE",id:"4\ufe0f\u20e3-force",level:3},{value:"5\ufe0f\u20e3 PURGE",id:"5\ufe0f\u20e3-purge",level:3},{value:"6\ufe0f\u20e3 VALIDATION_MODE",id:"6\ufe0f\u20e3-validation_mode",level:3},{value:"\ud83e\udde9 Real-World Use Case \u2014 RetailCo",id:"-real-world-use-case--retailco",level:2},{value:"\ud83e\udde0 Best Practices",id:"-best-practices",level:2},{value:"\ud83c\udfc1 Quick Summary",id:"-quick-summary",level:2}];function c(e){const n={blockquote:"blockquote",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"copy-into-command--complete-guide-with-all-options",children:"COPY INTO Command \u2014 Complete Guide with All Options"})}),"\n",(0,i.jsxs)(n.p,{children:["Welcome back to ",(0,i.jsx)(n.strong,{children:"RetailCo"}),", our fictional retail company.",(0,i.jsx)(n.br,{}),"\n","Alice, the data engineer, now has ",(0,i.jsx)(n.strong,{children:"staged data files"})," and needs to ",(0,i.jsx)(n.strong,{children:"load them into Snowflake tables"})," efficiently."]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:["\u201cThe COPY INTO command is like a ",(0,i.jsx)(n.strong,{children:"magic wand"})," \u2014 it moves data from your stage into tables safely and quickly,\u201d she explains."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Let\u2019s explore ",(0,i.jsx)(n.strong,{children:"how COPY INTO works"}),", all its options, and real-world use cases."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"\ufe0f-what-is-copy-into",children:"\ud83c\udfd7\ufe0f What Is COPY INTO?"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.strong,{children:"COPY INTO"})," command loads data ",(0,i.jsx)(n.strong,{children:"from a stage (internal or external) into a Snowflake table"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"Basic syntax:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"COPY INTO <table_name>\r\nFROM <stage_name>\r\nFILE_FORMAT = (TYPE = CSV)\r\nON_ERROR = 'CONTINUE';\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"<table_name>"})," \u2192 destination table"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"<stage_name>"})," \u2192 internal or external stage"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"FILE_FORMAT"})," \u2192 CSV, JSON, Parquet, etc."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"ON_ERROR"})," \u2192 what to do if errors occur"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"-key-options",children:"\ud83d\udd39 Key Options"}),"\n",(0,i.jsx)(n.h3,{id:"1\ufe0f\u20e3-file_format",children:"1\ufe0f\u20e3 FILE_FORMAT"}),"\n",(0,i.jsx)(n.p,{children:"Specifies how Snowflake interprets files:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"FILE_FORMAT = (TYPE = CSV FIELD_OPTIONALLY_ENCLOSED_BY='\"' SKIP_HEADER=1)\n"})}),"\n",(0,i.jsx)(n.p,{children:"Other formats: JSON, PARQUET, ORC."}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"2\ufe0f\u20e3-on_error",children:"2\ufe0f\u20e3 ON_ERROR"}),"\n",(0,i.jsx)(n.p,{children:"Controls error handling:"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Option"}),(0,i.jsx)(n.th,{children:"Behavior"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"CONTINUE"}),(0,i.jsx)(n.td,{children:"Skip bad files/rows, continue loading"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"ABORT_STATEMENT"}),(0,i.jsx)(n.td,{children:"Stop the load if an error occurs (default)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"SKIP_FILE"}),(0,i.jsx)(n.td,{children:"Skip the entire file if an error occurs"})]})]})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"RetailCo example:"})," Alice uses ",(0,i.jsx)(n.code,{children:"ON_ERROR='CONTINUE'"})," to skip malformed CSV rows while loading daily sales."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"3\ufe0f\u20e3-pattern",children:"3\ufe0f\u20e3 PATTERN"}),"\n",(0,i.jsx)(n.p,{children:"Load only specific files matching a regex:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"COPY INTO SALES\r\nFROM @RAW_SALES_STAGE\r\nFILE_FORMAT = (TYPE=CSV)\r\nPATTERN = '.*_jan.csv';\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Only files ending with ",(0,i.jsx)(n.code,{children:"_jan.csv"})," are loaded"]}),"\n",(0,i.jsx)(n.li,{children:"Useful for incremental loads"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"4\ufe0f\u20e3-force",children:"4\ufe0f\u20e3 FORCE"}),"\n",(0,i.jsx)(n.p,{children:"Forces reload of files even if they were already loaded:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"COPY INTO SALES\r\nFROM @RAW_SALES_STAGE\r\nFILE_FORMAT = (TYPE=CSV)\r\nFORCE = TRUE;\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Default: Snowflake ",(0,i.jsx)(n.strong,{children:"tracks loaded files"})," to avoid duplicates"]}),"\n",(0,i.jsx)(n.li,{children:"Use FORCE only if you want to reload intentionally"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"5\ufe0f\u20e3-purge",children:"5\ufe0f\u20e3 PURGE"}),"\n",(0,i.jsx)(n.p,{children:"Deletes files after successful load (internal stages only):"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"COPY INTO SALES\r\nFROM @%SALES\r\nFILE_FORMAT = (TYPE=CSV)\r\nPURGE = TRUE;\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Keeps internal stages clean"}),"\n",(0,i.jsx)(n.li,{children:"Saves storage costs"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"6\ufe0f\u20e3-validation_mode",children:"6\ufe0f\u20e3 VALIDATION_MODE"}),"\n",(0,i.jsx)(n.p,{children:"Check files without actually loading:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"COPY INTO SALES\r\nFROM @RAW_SALES_STAGE\r\nVALIDATION_MODE = RETURN_ERRORS;\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Useful for ",(0,i.jsx)(n.strong,{children:"pre-checking data quality"})]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"-real-world-use-case--retailco",children:"\ud83e\udde9 Real-World Use Case \u2014 RetailCo"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Daily sales CSVs arrive in ",(0,i.jsx)(n.code,{children:"@RAW_SALES_STAGE"})]}),"\n",(0,i.jsx)(n.li,{children:"Alice runs:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"COPY INTO SALES\r\nFROM @RAW_SALES_STAGE\r\nFILE_FORMAT=(TYPE=CSV FIELD_OPTIONALLY_ENCLOSED_BY='\"' SKIP_HEADER=1)\r\nON_ERROR='CONTINUE'\r\nPATTERN='.*_2025-11-27.csv';\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"3",children:["\n",(0,i.jsx)(n.li,{children:"Bad rows are skipped, valid rows load into table"}),"\n",(0,i.jsx)(n.li,{children:"Stage files are automatically purged after loading:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"COPY INTO SALES\r\nFROM @%SALES\r\nPURGE = TRUE;\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Result: ",(0,i.jsx)(n.strong,{children:"Clean, efficient, and automated daily data load workflow"}),"."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"-best-practices",children:"\ud83e\udde0 Best Practices"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Always ",(0,i.jsx)(n.strong,{children:"define a file format"})," matching your data"]}),"\n",(0,i.jsxs)(n.li,{children:["Use ",(0,i.jsx)(n.strong,{children:"ON_ERROR"})," wisely to handle unexpected data"]}),"\n",(0,i.jsxs)(n.li,{children:["Apply ",(0,i.jsx)(n.strong,{children:"PATTERN"})," for incremental or selective loads"]}),"\n",(0,i.jsxs)(n.li,{children:["Use ",(0,i.jsx)(n.strong,{children:"PURGE"})," for internal stages to save storage"]}),"\n",(0,i.jsxs)(n.li,{children:["Test with ",(0,i.jsx)(n.strong,{children:"VALIDATION_MODE"})," before production load"]}),"\n",(0,i.jsxs)(n.li,{children:["Leverage ",(0,i.jsx)(n.strong,{children:"FORCE"})," only when necessary to reload"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"-quick-summary",children:"\ud83c\udfc1 Quick Summary"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"COPY INTO"})," = primary command to load data from stages into Snowflake tables"]}),"\n",(0,i.jsxs)(n.li,{children:["Key options: ",(0,i.jsx)(n.strong,{children:"FILE_FORMAT, ON_ERROR, PATTERN, FORCE, PURGE, VALIDATION_MODE"})]}),"\n",(0,i.jsxs)(n.li,{children:["Supports ",(0,i.jsx)(n.strong,{children:"internal and external stages"})]}),"\n",(0,i.jsx)(n.li,{children:"Best practices: proper file formats, error handling, incremental loads, and stage cleanup"}),"\n",(0,i.jsxs)(n.li,{children:["Enables ",(0,i.jsx)(n.strong,{children:"fast, reliable, and production-ready ETL workflows"})]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h1,{id:"-coming-next",children:"\ud83d\ude80 Coming Next"}),"\n",(0,i.jsxs)(n.p,{children:["\ud83d\udc49 ",(0,i.jsx)(n.strong,{children:"Snowpipe \u2014 Real-Time Streaming Load with Example Pipeline"})]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},8453:(e,n,l)=>{l.d(n,{R:()=>a,x:()=>o});var s=l(6540);const i={},r=s.createContext(i);function a(e){const n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);