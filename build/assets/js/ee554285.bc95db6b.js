"use strict";(self.webpackChunkdatacraft_school=self.webpackChunkdatacraft_school||[]).push([[2632],{8453:(e,r,n)=>{n.d(r,{R:()=>d,x:()=>l});var s=n(6540);const i={},t=s.createContext(i);function d(e){const r=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function l(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:d(e.components),s.createElement(t.Provider,{value:r},e.children)}},8723:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>d,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"linear-regression-model","title":"Linear Regression - Explained Simply","description":"Predict ride fares using a linear regression model in a real-world example.","source":"@site/docs-pyspark/linear-regression-model.md","sourceDirName":".","slug":"/linear-regression-model","permalink":"/pyspark/linear-regression-model","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"linear-regression-model","title":"Linear Regression - Explained Simply","sidebar_label":"Linear Regression","description":"Predict ride fares using a linear regression model in a real-world example."}}');var i=n(4848),t=n(8453);n(6540),n(2303);const d={id:"linear-regression-model",title:"Linear Regression - Explained Simply",sidebar_label:"Linear Regression",description:"Predict ride fares using a linear regression model in a real-world example."},l=void 0,a={},c=[{value:"\ud83d\ude95 Predicting Ride Fares with Linear Regression",id:"-predicting-ride-fares-with-linear-regression",level:3},{value:"\ud83e\udde9 Understanding the Problem",id:"-understanding-the-problem",level:2},{value:"\ud83d\udcd8 What Is Linear Regression?",id:"-what-is-linear-regression",level:2},{value:"\ud83d\udcd0 The Formula",id:"-the-formula",level:3},{value:"How It Works in Practice",id:"how-it-works-in-practice",level:2},{value:"Let\u2019s Code It (with PySpark)",id:"lets-code-it-with-pyspark",level:2},{value:"Key Takeaways",id:"key-takeaways",level:2},{value:"\ud83e\udded 1-Minute Recap: Linear Regression",id:"-1-minute-recap-linear-regression",level:2}];function o(e){const r={blockquote:"blockquote",br:"br",code:"code",em:"em",h2:"h2",h3:"h3",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.h3,{id:"-predicting-ride-fares-with-linear-regression",children:"\ud83d\ude95 Predicting Ride Fares with Linear Regression"}),"\n",(0,i.jsxs)(r.p,{children:["Imagine you\u2019re part of a data science team at a ride-sharing company \u2014 something like ",(0,i.jsx)(r.strong,{children:"Uber"})," or ",(0,i.jsx)(r.strong,{children:"Lyft"}),"."]}),"\n",(0,i.jsx)(r.p,{children:"Your product manager asks:"}),"\n",(0,i.jsxs)(r.blockquote,{children:["\n",(0,i.jsx)(r.p,{children:"\ud83e\udde0 \u201cCan we predict the fare price of a ride based on distance, traffic, time of day, and weather?\u201d"}),"\n"]}),"\n",(0,i.jsxs)(r.p,{children:["This sounds like a perfect job for ",(0,i.jsx)(r.strong,{children:"Linear Regression"})," \u2014 one of the simplest yet most powerful algorithms for predicting ",(0,i.jsx)(r.strong,{children:"continuous values"})," such as prices, distances, or durations."]}),"\n",(0,i.jsx)(r.hr,{}),"\n",(0,i.jsx)(r.h2,{id:"-understanding-the-problem",children:"\ud83e\udde9 Understanding the Problem"}),"\n",(0,i.jsxs)(r.p,{children:["Your company has collected millions of historical ride records.",(0,i.jsx)(r.br,{}),"\n","Here\u2019s a small sample of what that data might look like:"]}),"\n",(0,i.jsxs)(r.table,{children:[(0,i.jsx)(r.thead,{children:(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.th,{children:"Distance (km)"}),(0,i.jsx)(r.th,{children:"Time of Day"}),(0,i.jsx)(r.th,{children:"Traffic Level"}),(0,i.jsx)(r.th,{children:"Weather"}),(0,i.jsx)(r.th,{children:"Fare ($)"})]})}),(0,i.jsxs)(r.tbody,{children:[(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"3"}),(0,i.jsx)(r.td,{children:"Morning"}),(0,i.jsx)(r.td,{children:"Low"}),(0,i.jsx)(r.td,{children:"Clear"}),(0,i.jsx)(r.td,{children:"6.50"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"5"}),(0,i.jsx)(r.td,{children:"Evening"}),(0,i.jsx)(r.td,{children:"High"}),(0,i.jsx)(r.td,{children:"Rainy"}),(0,i.jsx)(r.td,{children:"12.00"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"10"}),(0,i.jsx)(r.td,{children:"Afternoon"}),(0,i.jsx)(r.td,{children:"Medium"}),(0,i.jsx)(r.td,{children:"Clear"}),(0,i.jsx)(r.td,{children:"18.00"})]})]})]}),"\n",(0,i.jsxs)(r.p,{children:["Your goal is to train a model that can ",(0,i.jsx)(r.strong,{children:"learn from this data"})," and ",(0,i.jsx)(r.strong,{children:"predict fares for future rides"})," \u2014 even those it hasn\u2019t seen before."]}),"\n",(0,i.jsxs)(r.p,{children:["\ud83c\udfaf In short: given ride details like ",(0,i.jsx)(r.strong,{children:"distance"}),", ",(0,i.jsx)(r.strong,{children:"traffic"}),", and ",(0,i.jsx)(r.strong,{children:"weather"}),", the model should estimate a fair and accurate fare."]}),"\n",(0,i.jsxs)(r.p,{children:["That\u2019s where ",(0,i.jsx)(r.strong,{children:"Linear Regression"})," comes in \u2014 it\u2019s a perfect first model to learn and apply."]}),"\n",(0,i.jsx)(r.hr,{}),"\n",(0,i.jsx)(r.h2,{id:"-what-is-linear-regression",children:"\ud83d\udcd8 What Is Linear Regression?"}),"\n",(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.strong,{children:"Linear Regression"})," is a ",(0,i.jsx)(r.strong,{children:"supervised learning algorithm"})," used to predict a ",(0,i.jsx)(r.strong,{children:"numeric (continuous)"})," value from one or more input variables (called ",(0,i.jsx)(r.em,{children:"features"}),")."]}),"\n",(0,i.jsx)(r.p,{children:"The intuition is simple:"}),"\n",(0,i.jsxs)(r.blockquote,{children:["\n",(0,i.jsxs)(r.p,{children:["The output (fare) changes ",(0,i.jsx)(r.em,{children:"linearly"})," with the inputs (distance, time, traffic, etc.)."]}),"\n"]}),"\n",(0,i.jsx)(r.hr,{}),"\n",(0,i.jsx)(r.h3,{id:"-the-formula",children:"\ud83d\udcd0 The Formula"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-text",children:"y = w1\xb7x1 + w2\xb7x2 + ... + wn\xb7xn + b\n"})}),"\n",(0,i.jsxs)(r.table,{children:[(0,i.jsx)(r.thead,{children:(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.th,{children:"Term"}),(0,i.jsx)(r.th,{children:"Meaning"})]})}),(0,i.jsxs)(r.tbody,{children:[(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"y"})}),(0,i.jsx)(r.td,{children:"The value you want to predict (e.g., fare)"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"x1, x2, ..., xn"})}),(0,i.jsx)(r.td,{children:"The input features (e.g., distance, time, traffic)"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"w1, w2, ..., wn"})}),(0,i.jsx)(r.td,{children:"The weights \u2014 how important each feature is"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"b"})}),(0,i.jsx)(r.td,{children:"The bias \u2014 the base value when all inputs are zero (like a booking fee)"})]})]})]}),"\n",(0,i.jsx)(r.p,{children:"So, in our case:"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-text",children:"fare = w1*distance + w2*time + w3*traffic + w4*weather + b\n"})}),"\n",(0,i.jsx)(r.h2,{id:"how-it-works-in-practice",children:"How It Works in Practice"}),"\n",(0,i.jsx)(r.p,{children:"Let\u2019s assume your model is trained with these features:"}),"\n",(0,i.jsx)(r.p,{children:"x1 = distance (in km)\r\nx2 = hour (time of day)\r\nx3 = traffic level (numeric scale)\r\nx4 = weather (rain = 1, clear = 0)"}),"\n",(0,i.jsx)(r.p,{children:"The trained model will then predict fares using:"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-text",children:"fare = w1*distance + w2*hour + w3*traffic + w4*rain + b\n"})}),"\n",(0,i.jsx)(r.p,{children:"This equation becomes your ride fare prediction engine."}),"\n",(0,i.jsx)(r.h2,{id:"lets-code-it-with-pyspark",children:"Let\u2019s Code It (with PySpark)"}),"\n",(0,i.jsx)(r.p,{children:"Using PySpark, you can easily train a Linear Regression model that scales to millions of rows."}),"\n",(0,i.jsx)(r.p,{children:"Here\u2019s a simple example:"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-python",children:'from pyspark.ml.regression import LinearRegression\r\nfrom pyspark.ml.feature import VectorAssembler\r\n\r\n# Sample training data\r\ndata = [\r\n    (3, 8, 1, 0, 6.5),\r\n    (5, 18, 3, 1, 12.0),\r\n    (10, 14, 2, 0, 18.0)\r\n]\r\ndf = spark.createDataFrame(data, ["distance", "hour", "traffic", "rain", "fare"])\n'})}),"\n",(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.strong,{children:"Step 1: Combine Features with VectorAssembler"}),(0,i.jsx)(r.br,{}),"\n","PySpark\u2019s machine learning models expect all input features to be combined into a single column called features.\r\nThat\u2019s exactly what the VectorAssembler does \u2014 it merges multiple columns (like distance, hour, etc.) into one feature vector."]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-python",children:'assembler = VectorAssembler(\r\n    inputCols=["distance", "hour", "traffic", "rain"],\r\n    outputCol="features"\r\n)\r\ndf_features = assembler.transform(df).select("features", "fare")\n'})}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.strong,{children:"Step 2: Train the Linear Regression Model"})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-python",children:'lr = LinearRegression(featuresCol="features", labelCol="fare")\r\nmodel = lr.fit(df_features)\n'})}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.strong,{children:"Step 3: Make Predictions"})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-python",children:"predictions = model.transform(df_features)\r\npredictions.show()\n"})}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.strong,{children:"Step 4: Inspect the Learned Model"})}),"\n",(0,i.jsx)(r.p,{children:"Let\u2019s check what the model learned \u2014 the weights (w) and bias (b):"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-python",children:'print("Weights (w):", model.coefficients)\r\nprint("Bias (b):", model.intercept)\n'})}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.strong,{children:"Example Output"})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-text",children:"Weights (w): [1.5, 0.2, 2.0, 1.0]\r\nBias (b): 3.0\n"})}),"\n",(0,i.jsx)(r.p,{children:"So your model equation is:"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-text",children:"fare = 1.5*distance + 0.2*hour + 2.0*traffic + 1.0*rain + 3.0\n"})}),"\n",(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.strong,{children:"Step 5: Test the Model on a New Ride"}),"\r\nLet\u2019s plug in a new ride:"]}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:"Distance: 7 km"}),"\n",(0,i.jsx)(r.li,{children:"Hour: 17 (5 PM)"}),"\n",(0,i.jsx)(r.li,{children:"Traffic: 2 (Moderate)"}),"\n",(0,i.jsx)(r.li,{children:"Rain: 1 (Yes)"}),"\n"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-text",children:"fare = 1.5*7 + 0.2*17 + 2.0*2 + 1.0*1 + 3.0\r\n     = 10.5 + 3.4 + 4.0 + 1.0 + 3.0\r\n     = $21.90\n"})}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.strong,{children:"\ud83c\udf89 Predicted Fare: $21.90"})}),"\n",(0,i.jsx)(r.h2,{id:"key-takeaways",children:"Key Takeaways"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:["\n",(0,i.jsx)(r.p,{children:"Linear Regression is the foundation of many advanced ML models."}),"\n"]}),"\n",(0,i.jsxs)(r.li,{children:["\n",(0,i.jsx)(r.p,{children:"PySpark\u2019s VectorAssembler combines columns into one feature vector for model training."}),"\n"]}),"\n",(0,i.jsxs)(r.li,{children:["\n",(0,i.jsx)(r.p,{children:"You can easily interpret model outputs to see which factors influence prices most."}),"\n"]}),"\n",(0,i.jsxs)(r.li,{children:["\n",(0,i.jsx)(r.p,{children:"Great for beginners to understand predictive modeling at scale."}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(r.h2,{id:"-1-minute-recap-linear-regression",children:"\ud83e\udded 1-Minute Recap: Linear Regression"}),"\n",(0,i.jsxs)(r.table,{children:[(0,i.jsx)(r.thead,{children:(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.th,{children:(0,i.jsx)(r.strong,{children:"Section"})}),(0,i.jsx)(r.th,{children:(0,i.jsx)(r.strong,{children:"Details"})})]})}),(0,i.jsxs)(r.tbody,{children:[(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.strong,{children:"Use Case"})}),(0,i.jsx)(r.td,{children:"Predict ride fare prices based on ride data (distance, time, traffic, weather)."})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.strong,{children:"Problem Type"})}),(0,i.jsxs)(r.td,{children:["Regression \u2013 predicting a ",(0,i.jsx)(r.strong,{children:"continuous"})," value (fare)."]})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.strong,{children:"Algorithm"})}),(0,i.jsx)(r.td,{children:"Linear Regression (Supervised Learning)"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.strong,{children:"Model Formula"})}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"y = w1\xb7x1 + w2\xb7x2 + ... + wn\xb7xn + b"})})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsxs)(r.strong,{children:["Target (",(0,i.jsx)(r.code,{children:"y"}),")"]})}),(0,i.jsx)(r.td,{children:"Fare (price of the ride)"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsxs)(r.strong,{children:["Features (",(0,i.jsx)(r.code,{children:"x1...xn"}),")"]})}),(0,i.jsx)(r.td,{children:"Distance, Hour, Traffic, Rain"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsxs)(r.strong,{children:["Weights (",(0,i.jsx)(r.code,{children:"w1...wn"}),")"]})}),(0,i.jsx)(r.td,{children:"Importance of each feature"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsxs)(r.strong,{children:["Bias (",(0,i.jsx)(r.code,{children:"b"}),")"]})}),(0,i.jsx)(r.td,{children:"Base fare (booking fee)"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.strong,{children:"Goal of Model"})}),(0,i.jsx)(r.td,{children:"Find the best weights and bias to minimize prediction error"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.strong,{children:"Training Data Example"})}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"(distance=3, hour=8, traffic=1, rain=0, fare=6.5)"})})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.strong,{children:"Learned Model"})}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"fare = 1.5*distance + 0.2*hour + 2.0*traffic + 1.0*rain + 3.0"})})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.strong,{children:"Prediction Example"})}),(0,i.jsx)(r.td,{children:"Distance=7, Hour=17, Traffic=2, Rain=1"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.strong,{children:"Predicted Fare"})}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"$21.90"})})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.strong,{children:"You Learned"})}),(0,i.jsx)(r.td,{children:"How to frame a regression problem, train a PySpark model, and interpret weights & bias"})]})]})]})]})}function h(e={}){const{wrapper:r}={...(0,t.R)(),...e.components};return r?(0,i.jsx)(r,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}}}]);