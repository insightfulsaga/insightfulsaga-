"use strict";(self.webpackChunkdatacraft_school=self.webpackChunkdatacraft_school||[]).push([[8156],{582:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>t,default:()=>h,frontMatter:()=>i,metadata:()=>a,toc:()=>d});const a=JSON.parse('{"id":"snowflake-incremental-loading-cdc","title":"Incremental Loading (CDC) in Snowflake \u2014 5 Real Techniques","description":"Beginner-friendly, story-driven guide to incremental loading (CDC) in Snowflake with 5 practical techniques and real-world examples.","source":"@site/docs-snowflake/snowflake-incremental-loading-cdc.md","sourceDirName":".","slug":"/snowflake-incremental-loading-cdc","permalink":"/snowflake/snowflake-incremental-loading-cdc","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"snowflake-incremental-loading-cdc","title":"Incremental Loading (CDC) in Snowflake \u2014 5 Real Techniques","sidebar_label":"Incremental Loading","description":"Beginner-friendly, story-driven guide to incremental loading (CDC) in Snowflake with 5 practical techniques and real-world examples.","keywords":["Snowflake CDC","Snowflake incremental load","Snowflake data pipelines","Snowflake change data capture","Snowflake ETL best practices"]},"sidebar":"tutorialSidebar1","previous":{"title":"Snowpipe","permalink":"/snowflake/snowflake-snowpipe"},"next":{"title":"Snowflake Tasks","permalink":"/snowflake/snowflake-tasks-cron"}}');var l=s(4848),r=s(8453);const i={id:"snowflake-incremental-loading-cdc",title:"Incremental Loading (CDC) in Snowflake \u2014 5 Real Techniques",sidebar_label:"Incremental Loading",description:"Beginner-friendly, story-driven guide to incremental loading (CDC) in Snowflake with 5 practical techniques and real-world examples.",keywords:["Snowflake CDC","Snowflake incremental load","Snowflake data pipelines","Snowflake change data capture","Snowflake ETL best practices"]},t="Incremental Loading (CDC) in Snowflake \u2014 5 Real Techniques",c={},d=[{value:"\ud83c\udfd7\ufe0f Why Incremental Loading Matters",id:"\ufe0f-why-incremental-loading-matters",level:2},{value:"\ud83d\udd39 Technique 1: Timestamp-Based Incremental Load",id:"-technique-1-timestamp-based-incremental-load",level:3},{value:"\ud83d\udd39 Technique 2: Sequence Number or ID-Based Incremental Load",id:"-technique-2-sequence-number-or-id-based-incremental-load",level:3},{value:"\ud83d\udd39 Technique 3: Merge Statement (Upsert)",id:"-technique-3-merge-statement-upsert",level:3},{value:"\ud83d\udd39 Technique 4: Snowflake Streams + Tasks",id:"-technique-4-snowflake-streams--tasks",level:3},{value:"\ud83d\udd39 Technique 5: Hash-Based Comparison",id:"-technique-5-hash-based-comparison",level:3},{value:"\ud83e\udde9 RetailCo Real-World CDC Scenario",id:"-retailco-real-world-cdc-scenario",level:2},{value:"\ud83c\udfc1 Quick Summary",id:"-quick-summary",level:2}];function o(e){const n={blockquote:"blockquote",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"incremental-loading-cdc-in-snowflake--5-real-techniques",children:"Incremental Loading (CDC) in Snowflake \u2014 5 Real Techniques"})}),"\n",(0,l.jsxs)(n.p,{children:["Welcome back to ",(0,l.jsx)(n.strong,{children:"RetailCo"}),", our fictional retail company.",(0,l.jsx)(n.br,{}),"\n","Alice, the data engineer, is now dealing with ",(0,l.jsx)(n.strong,{children:"large tables that get frequent updates"}),". Loading the full table every day wastes time and storage."]}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsxs)(n.p,{children:["\u201cWe need ",(0,l.jsx)(n.strong,{children:"incremental loading"}),", also called Change Data Capture (CDC), to only load new or updated rows,\u201d she explains."]}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["Let\u2019s explore ",(0,l.jsx)(n.strong,{children:"5 real techniques for incremental loading in Snowflake"}),"."]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"\ufe0f-why-incremental-loading-matters",children:"\ud83c\udfd7\ufe0f Why Incremental Loading Matters"}),"\n",(0,l.jsx)(n.p,{children:"Without incremental loading:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"ETL jobs become slow and costly"}),"\n",(0,l.jsx)(n.li,{children:"Storage and compute costs increase"}),"\n",(0,l.jsx)(n.li,{children:"Analytics dashboards lag behind real-time updates"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"With incremental loading:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Only changed data is loaded"}),"\n",(0,l.jsx)(n.li,{children:"Jobs run faster and cheaper"}),"\n",(0,l.jsx)(n.li,{children:"Reports stay up-to-date"}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h3,{id:"-technique-1-timestamp-based-incremental-load",children:"\ud83d\udd39 Technique 1: Timestamp-Based Incremental Load"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Use a ",(0,l.jsx)(n.code,{children:"LAST_UPDATED"})," timestamp column"]}),"\n",(0,l.jsxs)(n.li,{children:["Load rows where ",(0,l.jsx)(n.code,{children:"LAST_UPDATED"})," > last ETL run"]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Example:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sql",children:"INSERT INTO SALES_STG\r\nSELECT *\r\nFROM SALES_RAW\r\nWHERE LAST_UPDATED > (SELECT MAX(LAST_UPDATED) FROM SALES);\n"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Simple and efficient for append/update scenarios"}),"\n",(0,l.jsx)(n.li,{children:"Works well for tables with timestamp tracking"}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h3,{id:"-technique-2-sequence-number-or-id-based-incremental-load",children:"\ud83d\udd39 Technique 2: Sequence Number or ID-Based Incremental Load"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Use an auto-incrementing ID column"}),"\n",(0,l.jsx)(n.li,{children:"Load rows where ID > last loaded ID"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Example:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sql",children:"INSERT INTO ORDERS_STG\r\nSELECT *\r\nFROM ORDERS_RAW\r\nWHERE ORDER_ID > (SELECT MAX(ORDER_ID) FROM ORDERS);\n"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Ideal for append-only datasets"}),"\n",(0,l.jsx)(n.li,{children:"Very fast, especially for large tables"}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h3,{id:"-technique-3-merge-statement-upsert",children:"\ud83d\udd39 Technique 3: Merge Statement (Upsert)"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Handles ",(0,l.jsx)(n.strong,{children:"insert + update"})]}),"\n",(0,l.jsxs)(n.li,{children:["Uses Snowflake ",(0,l.jsx)(n.code,{children:"MERGE"})," to apply changes"]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Example:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sql",children:"MERGE INTO SALES AS target\r\nUSING SALES_STG AS source\r\nON target.SALE_ID = source.SALE_ID\r\nWHEN MATCHED THEN UPDATE SET target.QUANTITY = source.QUANTITY\r\nWHEN NOT MATCHED THEN INSERT (SALE_ID, PRODUCT_ID, QUANTITY, SALE_DATE)\r\nVALUES (source.SALE_ID, source.PRODUCT_ID, source.QUANTITY, source.SALE_DATE);\n"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Ensures table stays up-to-date"}),"\n",(0,l.jsx)(n.li,{children:"Handles updates, not just new rows"}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h3,{id:"-technique-4-snowflake-streams--tasks",children:"\ud83d\udd39 Technique 4: Snowflake Streams + Tasks"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Streams"})," track table changes automatically"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Tasks"})," schedule incremental load pipelines"]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"RetailCo Example:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sql",children:"CREATE STREAM SALES_STREAM ON TABLE SALES_RAW;\r\n\r\nCREATE TASK SALES_TASK\r\nWAREHOUSE = ETL_WH\r\nSCHEDULE = 'USING CRON 0 * * * *'\r\nAS\r\nMERGE INTO SALES\r\nUSING SALES_STREAM\r\nON SALES.SALE_ID = SALES_STREAM.SALE_ID\r\nWHEN MATCHED THEN UPDATE SET QUANTITY = SALES_STREAM.QUANTITY\r\nWHEN NOT MATCHED THEN INSERT (SALE_ID, PRODUCT_ID, QUANTITY, SALE_DATE)\r\nVALUES (SALES_STREAM.SALE_ID, SALES_STREAM.PRODUCT_ID, SALES_STREAM.QUANTITY, SALES_STREAM.SALE_DATE);\n"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Fully automated incremental ETL"}),"\n",(0,l.jsx)(n.li,{children:"Real-time or near-real-time data updates"}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h3,{id:"-technique-5-hash-based-comparison",children:"\ud83d\udd39 Technique 5: Hash-Based Comparison"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Generate a hash of each row (MD5, SHA256)"}),"\n",(0,l.jsx)(n.li,{children:"Compare hashes to detect changes"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Example:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sql",children:"INSERT INTO SALES_STG\r\nSELECT *\r\nFROM SALES_RAW r\r\nWHERE MD5(TO_VARIANT(r.*)) NOT IN (SELECT HASH FROM SALES);\n"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Useful for datasets without timestamps or IDs"}),"\n",(0,l.jsx)(n.li,{children:"Detects both inserts and updates"}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"-retailco-real-world-cdc-scenario",children:"\ud83e\udde9 RetailCo Real-World CDC Scenario"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Daily Sales:"})," Timestamp-based load"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Orders Table:"})," Sequence ID-based incremental load"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Inventory Updates:"})," MERGE to handle insert + update"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Streaming Events:"})," Snowflake Streams + Tasks for near real-time"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Vendor Data:"})," Hash comparison for unknown updates"]}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["Result: ",(0,l.jsx)(n.strong,{children:"Faster ETL, lower costs, and up-to-date dashboards"}),"."]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"-quick-summary",children:"\ud83c\udfc1 Quick Summary"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Incremental loading (CDC)"})," ensures only new/changed data is loaded"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"5 techniques:"})," Timestamp-based, Sequence/ID-based, Merge (Upsert), Streams + Tasks, Hash-based"]}),"\n",(0,l.jsx)(n.li,{children:"Best practice: choose technique based on dataset type and update pattern"}),"\n",(0,l.jsx)(n.li,{children:"Benefits: faster ETL, reduced compute/storage cost, real-time or near-real-time analytics"}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h1,{id:"-coming-next",children:"\ud83d\ude80 Coming Next"}),"\n",(0,l.jsxs)(n.p,{children:["\ud83d\udc49 ",(0,l.jsx)(n.strong,{children:"Automation of Data Loads Using Tasks (Cron Style Scheduling)"})]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(o,{...e})}):o(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>i,x:()=>t});var a=s(6540);const l={},r=a.createContext(l);function i(e){const n=a.useContext(r);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:i(e.components),a.createElement(r.Provider,{value:n},e.children)}}}]);