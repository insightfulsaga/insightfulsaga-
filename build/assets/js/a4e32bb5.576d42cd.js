"use strict";(self.webpackChunkdatacraft_school=self.webpackChunkdatacraft_school||[]).push([[2131],{3712:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>o,contentTitle:()=>c,default:()=>h,frontMatter:()=>a,metadata:()=>l,toc:()=>t});const l=JSON.parse('{"id":"snowflake-row-access-policies-rls","title":"Row Access Policies \u2014 Row Level Security (RLS)","description":"A story-driven guide explaining Snowflake Row Access Policies (RLS), including real-world enterprise security scenarios, SQL examples, multi-tenant architectures, and compliance-focused best practices.","source":"@site/docs-snowflake/snowflake-row-access-policies-rls.md","sourceDirName":".","slug":"/snowflake-row-access-policies-rls","permalink":"/snowflake/snowflake-row-access-policies-rls","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"snowflake-row-access-policies-rls","title":"Row Access Policies \u2014 Row Level Security (RLS)","sidebar_label":"Row-Level Security (RLS)","description":"A story-driven guide explaining Snowflake Row Access Policies (RLS), including real-world enterprise security scenarios, SQL examples, multi-tenant architectures, and compliance-focused best practices.","keywords":["Snowflake row access policies","Snowflake RLS","Snowflake row level security","attribute based access control","Snowflake governance","data security snowflake","multi-tenant snowflake architecture"]},"sidebar":"tutorialSidebar1","previous":{"title":"Dynamic Data Masking","permalink":"/snowflake/snowflake-dynamic-data-masking-use-cases"},"next":{"title":"Costs & Billing","permalink":"/snowflake/snowflake-costs-billing-dashboard-monitoring"}}');var i=n(4848),r=n(8453);const a={id:"snowflake-row-access-policies-rls",title:"Row Access Policies \u2014 Row Level Security (RLS)",sidebar_label:"Row-Level Security (RLS)",description:"A story-driven guide explaining Snowflake Row Access Policies (RLS), including real-world enterprise security scenarios, SQL examples, multi-tenant architectures, and compliance-focused best practices.",keywords:["Snowflake row access policies","Snowflake RLS","Snowflake row level security","attribute based access control","Snowflake governance","data security snowflake","multi-tenant snowflake architecture"]},c="Row Access Policies \u2014 Row Level Security (RLS)",o={},t=[{value:"\ud83c\udfac Story Time \u2014 \u201cOnly Show Me My Region\u2019s Data\u201d",id:"-story-time--only-show-me-my-regions-data",level:2},{value:"\ud83d\udee1\ufe0f 1. What Are Row Access Policies?",id:"\ufe0f-1-what-are-row-access-policies",level:2},{value:"\ud83d\udd27 2. Create Your First RLS Policy",id:"-2-create-your-first-rls-policy",level:2},{value:"\ud83e\udde9 3. Real Enterprise Use Cases for RLS",id:"-3-real-enterprise-use-cases-for-rls",level:2},{value:"\u2b50 Use Case 1: Department-Based Security",id:"-use-case-1-department-based-security",level:3},{value:"\u2b50 Use Case 2: Multi-Tenant SaaS Architecture",id:"-use-case-2-multi-tenant-saas-architecture",level:3},{value:"\u2b50 Use Case 3: Employee Hierarchy Access",id:"-use-case-3-employee-hierarchy-access",level:3},{value:"\u2b50 Use Case 4: Geo-Based Regulatory Compliance",id:"-use-case-4-geo-based-regulatory-compliance",level:3},{value:"\u2b50 Use Case 5: RLS With Lookup Table (Best Practice)",id:"-use-case-5-rls-with-lookup-table-best-practice",level:3},{value:"1. Create mapping table",id:"1-create-mapping-table",level:4},{value:"2. Create dynamic RLS policy",id:"2-create-dynamic-rls-policy",level:4},{value:"\ud83d\udd04 4. Applying RLS to Views, Tables &amp; Columns",id:"-4-applying-rls-to-views-tables--columns",level:2},{value:"Apply to a table:",id:"apply-to-a-table",level:3},{value:"Apply to a secure view:",id:"apply-to-a-secure-view",level:3},{value:"\ud83e\udde0 5. How RLS Works Behind the Scenes",id:"-5-how-rls-works-behind-the-scenes",level:2},{value:"\ud83e\uddea 6. Testing RLS",id:"-6-testing-rls",level:2},{value:"\ud83e\uddf1 7. Performance Considerations",id:"-7-performance-considerations",level:2},{value:"\ud83c\udf1f Best Practices",id:"-best-practices",level:2},{value:"\ud83c\udf89 Real-World Ending \u2014 \u201cSecure Data, Happier Teams\u201d",id:"-real-world-ending--secure-data-happier-teams",level:2},{value:"\ud83d\udcd8 Summary",id:"-summary",level:2},{value:"\u2714 Row-level filtering",id:"-row-level-filtering",level:3},{value:"\u2714 Conditional visibility",id:"-conditional-visibility",level:3},{value:"\u2714 Multi-tenant isolation",id:"-multi-tenant-isolation",level:3},{value:"\u2714 Regulatory compliance",id:"-regulatory-compliance",level:3},{value:"\u2714 Real-time enforcement",id:"-real-time-enforcement",level:3},{value:"\u2714 Seamless integration with governance tools",id:"-seamless-integration-with-governance-tools",level:3}];function d(e){const s={blockquote:"blockquote",br:"br",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.header,{children:(0,i.jsx)(s.h1,{id:"row-access-policies--row-level-security-rls",children:"Row Access Policies \u2014 Row Level Security (RLS)"})}),"\n",(0,i.jsx)(s.h2,{id:"-story-time--only-show-me-my-regions-data",children:"\ud83c\udfac Story Time \u2014 \u201cOnly Show Me My Region\u2019s Data\u201d"}),"\n",(0,i.jsx)(s.p,{children:"Ravi, a regional data manager at a global retail company, logs into Snowflake."}),"\n",(0,i.jsxs)(s.p,{children:["He runs a revenue dashboard query\u2026",(0,i.jsx)(s.br,{}),"\n","But suddenly realizes:"]}),"\n",(0,i.jsxs)(s.blockquote,{children:["\n",(0,i.jsxs)(s.p,{children:["\u201cWait\u2026 am I seeing ",(0,i.jsx)(s.em,{children:"everyone\u2019s"})," revenue?\u201d"]}),"\n"]}),"\n",(0,i.jsxs)(s.p,{children:["Not good.",(0,i.jsx)(s.br,{}),"\n","Each region should only see its own data:"]}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"North America \u2192 sees NA rows"}),"\n",(0,i.jsx)(s.li,{children:"Europe \u2192 sees EU rows"}),"\n",(0,i.jsx)(s.li,{children:"Asia \u2192 sees APAC rows"}),"\n"]}),"\n",(0,i.jsxs)(s.p,{children:["Analysts should see all regions,",(0,i.jsx)(s.br,{}),"\n","but partners should only see theirs."]}),"\n",(0,i.jsxs)(s.p,{children:["Snowflake\u2019s ",(0,i.jsx)(s.strong,{children:"Row Access Policies (RLS)"})," save the day."]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"\ufe0f-1-what-are-row-access-policies",children:"\ud83d\udee1\ufe0f 1. What Are Row Access Policies?"}),"\n",(0,i.jsxs)(s.p,{children:["Row Access Policies restrict which ",(0,i.jsx)(s.strong,{children:"rows"})," a user or role may query."]}),"\n",(0,i.jsx)(s.p,{children:"They enforce security at row level by checking:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"user"}),"\n",(0,i.jsx)(s.li,{children:"role"}),"\n",(0,i.jsx)(s.li,{children:"attributes (e.g., employee region)"}),"\n",(0,i.jsx)(s.li,{children:"tags"}),"\n",(0,i.jsx)(s.li,{children:"lookup tables"}),"\n"]}),"\n",(0,i.jsxs)(s.p,{children:["RLS is fully dynamic \u2014 enforced ",(0,i.jsx)(s.strong,{children:"during query execution"}),", not during data storage."]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"-2-create-your-first-rls-policy",children:"\ud83d\udd27 2. Create Your First RLS Policy"}),"\n",(0,i.jsx)(s.p,{children:"Ravi starts with a simple rule:"}),"\n",(0,i.jsx)(s.p,{children:"\u201cUsers in the NA role can only see region = 'NorthAmerica' rows.\u201d"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-sql",children:"CREATE ROW ACCESS POLICY region_rls\r\nAS (region STRING) RETURNS BOOLEAN ->\r\nCASE\r\n  WHEN CURRENT_ROLE() = 'NA_MANAGER' AND region = 'NorthAmerica' THEN TRUE\r\n  WHEN CURRENT_ROLE() = 'EU_MANAGER' AND region = 'Europe' THEN TRUE\r\n  ELSE FALSE\r\nEND;\n"})}),"\n",(0,i.jsx)(s.p,{children:"Apply to the sales table:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-sql",children:"ALTER TABLE sales \r\nADD ROW ACCESS POLICY region_rls ON (region);\n"})}),"\n",(0,i.jsx)(s.p,{children:"Now, each region manager sees only their rows."}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"-3-real-enterprise-use-cases-for-rls",children:"\ud83e\udde9 3. Real Enterprise Use Cases for RLS"}),"\n",(0,i.jsx)(s.h3,{id:"-use-case-1-department-based-security",children:"\u2b50 Use Case 1: Department-Based Security"}),"\n",(0,i.jsx)(s.p,{children:"Finance sees all rows.\r\nHR sees only HR rows:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-sql",children:"CREATE ROW ACCESS POLICY dept_rls\r\nAS (department STRING) RETURNS BOOLEAN ->\r\nCASE\r\n  WHEN CURRENT_ROLE() = 'FINANCE_ANALYST' THEN TRUE\r\n  WHEN CURRENT_ROLE() = 'HR_USER' AND department = 'HR' THEN TRUE\r\n  ELSE FALSE\r\nEND;\n"})}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h3,{id:"-use-case-2-multi-tenant-saas-architecture",children:"\u2b50 Use Case 2: Multi-Tenant SaaS Architecture"}),"\n",(0,i.jsx)(s.p,{children:"Each tenant should only see their own data."}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-sql",children:"CREATE ROW ACCESS POLICY tenant_rls\r\nAS (tenant_id STRING) RETURNS BOOLEAN ->\r\ntenant_id = CURRENT_USER();\n"})}),"\n",(0,i.jsx)(s.p,{children:"Perfect for:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"SaaS products"}),"\n",(0,i.jsx)(s.li,{children:"Embedded analytics"}),"\n",(0,i.jsx)(s.li,{children:"Shared databases for multiple customers"}),"\n"]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h3,{id:"-use-case-3-employee-hierarchy-access",children:"\u2b50 Use Case 3: Employee Hierarchy Access"}),"\n",(0,i.jsx)(s.p,{children:"Managers see rows for their employees; employees see only themselves."}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-sql",children:"CREATE ROW ACCESS POLICY employee_rls\r\nAS (emp_id STRING) RETURNS BOOLEAN ->\r\nemp_id = CURRENT_USER()\r\nOR emp_id IN (\r\n    SELECT subordinate_id \r\n    FROM employee_hierarchy \r\n    WHERE manager_id = CURRENT_USER()\r\n);\n"})}),"\n",(0,i.jsx)(s.p,{children:"This supports:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Org charts"}),"\n",(0,i.jsx)(s.li,{children:"Supervisory workflows"}),"\n",(0,i.jsx)(s.li,{children:"Call center analytics"}),"\n"]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h3,{id:"-use-case-4-geo-based-regulatory-compliance",children:"\u2b50 Use Case 4: Geo-Based Regulatory Compliance"}),"\n",(0,i.jsx)(s.p,{children:"EU employees cannot see US customer data due to GDPR rules."}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-sql",children:"CREATE ROW ACCESS POLICY geo_compliance_rls\r\nAS (country STRING) RETURNS BOOLEAN ->\r\nCASE\r\n  WHEN CURRENT_REGION() = 'EU' AND country != 'USA' THEN TRUE\r\n  WHEN CURRENT_REGION() != 'EU' THEN TRUE\r\n  ELSE FALSE\r\nEND;\n"})}),"\n",(0,i.jsx)(s.p,{children:"Built for international data locality requirements."}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h3,{id:"-use-case-5-rls-with-lookup-table-best-practice",children:"\u2b50 Use Case 5: RLS With Lookup Table (Best Practice)"}),"\n",(0,i.jsxs)(s.p,{children:["Instead of hardcoding rules, Ravi uses a ",(0,i.jsx)(s.strong,{children:"mapping table"}),"."]}),"\n",(0,i.jsx)(s.h4,{id:"1-create-mapping-table",children:"1. Create mapping table"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-sql",children:"CREATE TABLE rls_map (\r\n  role STRING,\r\n  allowed_region STRING\r\n);\n"})}),"\n",(0,i.jsx)(s.h4,{id:"2-create-dynamic-rls-policy",children:"2. Create dynamic RLS policy"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-sql",children:"CREATE ROW ACCESS POLICY dynamic_rls\r\nAS (region STRING) RETURNS BOOLEAN ->\r\nregion IN (\r\n  SELECT allowed_region \r\n  FROM rls_map\r\n  WHERE role = CURRENT_ROLE()\r\n);\n"})}),"\n",(0,i.jsx)(s.p,{children:"This approach scales to:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"thousands of stores"}),"\n",(0,i.jsx)(s.li,{children:"hundreds of regions"}),"\n",(0,i.jsx)(s.li,{children:"dozens of roles"}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"Minimal SQL changes."}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"-4-applying-rls-to-views-tables--columns",children:"\ud83d\udd04 4. Applying RLS to Views, Tables & Columns"}),"\n",(0,i.jsx)(s.h3,{id:"apply-to-a-table",children:"Apply to a table:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-sql",children:"ALTER TABLE orders ADD ROW ACCESS POLICY dynamic_rls ON (region);\n"})}),"\n",(0,i.jsx)(s.h3,{id:"apply-to-a-secure-view",children:"Apply to a secure view:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-sql",children:"CREATE SECURE VIEW regional_view AS\r\nSELECT * FROM orders;\n"})}),"\n",(0,i.jsx)(s.p,{children:"RLS works automatically."}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"-5-how-rls-works-behind-the-scenes",children:"\ud83e\udde0 5. How RLS Works Behind the Scenes"}),"\n",(0,i.jsx)(s.p,{children:"When a query runs:"}),"\n",(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsx)(s.li,{children:"Snowflake evaluates the policy"}),"\n",(0,i.jsxs)(s.li,{children:["Filters rows ",(0,i.jsx)(s.em,{children:"before"})," query results"]}),"\n",(0,i.jsx)(s.li,{children:"Applies masking policies afterwards"}),"\n",(0,i.jsx)(s.li,{children:"Returns only authorized data"}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"RLS interacts seamlessly with:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Tags"}),"\n",(0,i.jsx)(s.li,{children:"Masking Policies"}),"\n",(0,i.jsx)(s.li,{children:"Secure Views"}),"\n",(0,i.jsx)(s.li,{children:"Access Control"}),"\n",(0,i.jsx)(s.li,{children:"Snowflake Sharing (Secure Shares)"}),"\n"]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"-6-testing-rls",children:"\ud83e\uddea 6. Testing RLS"}),"\n",(0,i.jsx)(s.p,{children:"Switch roles to validate:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-sql",children:"USE ROLE NA_MANAGER;\r\nSELECT region, revenue FROM sales;\r\n\r\nUSE ROLE EU_MANAGER;\r\nSELECT region, revenue FROM sales;\r\n\r\nUSE ROLE ANALYTICS_TEAM;\r\nSELECT region, revenue FROM sales;\n"})}),"\n",(0,i.jsx)(s.p,{children:"Results differ by role \u2014 without modifying the actual table."}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"-7-performance-considerations",children:"\ud83e\uddf1 7. Performance Considerations"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"RLS is metadata-based \u2192 no physical data copy"}),"\n",(0,i.jsx)(s.li,{children:"Polices are evaluated at query time"}),"\n",(0,i.jsx)(s.li,{children:"Works efficiently with micro-partition pruning"}),"\n",(0,i.jsx)(s.li,{children:"Use lookup tables for scalable logic"}),"\n",(0,i.jsx)(s.li,{children:"Complex expressions can slow queries \u2192 keep policies efficient"}),"\n"]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"-best-practices",children:"\ud83c\udf1f Best Practices"}),"\n",(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsxs)(s.li,{children:["Use ",(0,i.jsx)(s.strong,{children:"lookup tables"}),", not hardcoded roles"]}),"\n",(0,i.jsxs)(s.li,{children:["Combine RLS with ",(0,i.jsx)(s.strong,{children:"masking"})," for column-level protection"]}),"\n",(0,i.jsx)(s.li,{children:"Avoid nested CASE statements"}),"\n",(0,i.jsxs)(s.li,{children:["Apply policies to ",(0,i.jsx)(s.strong,{children:"root tables"}),", not derived views"]}),"\n",(0,i.jsx)(s.li,{children:"Document every RLS policy in a governance catalog"}),"\n",(0,i.jsx)(s.li,{children:"Audit row-level access using Access History"}),"\n",(0,i.jsxs)(s.li,{children:["Use ",(0,i.jsx)(s.strong,{children:"Secure Views"})," for added protection when sharing data"]}),"\n"]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"-real-world-ending--secure-data-happier-teams",children:"\ud83c\udf89 Real-World Ending \u2014 \u201cSecure Data, Happier Teams\u201d"}),"\n",(0,i.jsx)(s.p,{children:"After deploying RLS:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Regional managers see only their regions"}),"\n",(0,i.jsx)(s.li,{children:"Analysts get full visibility"}),"\n",(0,i.jsx)(s.li,{children:"Legal & compliance teams sleep peacefully"}),"\n",(0,i.jsx)(s.li,{children:"No duplicate tables"}),"\n",(0,i.jsx)(s.li,{children:"No custom ETL pipelines"}),"\n",(0,i.jsx)(s.li,{children:"No manual partitions"}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"Ravi's dashboard now shows only the right data to the right people."}),"\n",(0,i.jsx)(s.p,{children:"His boss says:"}),"\n",(0,i.jsxs)(s.blockquote,{children:["\n",(0,i.jsx)(s.p,{children:"\u201cThis is security done right \u2014 invisible, accurate, and scalable.\u201d"}),"\n"]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"-summary",children:"\ud83d\udcd8 Summary"}),"\n",(0,i.jsx)(s.p,{children:"Snowflake Row Access Policies provide:"}),"\n",(0,i.jsx)(s.h3,{id:"-row-level-filtering",children:"\u2714 Row-level filtering"}),"\n",(0,i.jsx)(s.h3,{id:"-conditional-visibility",children:"\u2714 Conditional visibility"}),"\n",(0,i.jsx)(s.h3,{id:"-multi-tenant-isolation",children:"\u2714 Multi-tenant isolation"}),"\n",(0,i.jsx)(s.h3,{id:"-regulatory-compliance",children:"\u2714 Regulatory compliance"}),"\n",(0,i.jsx)(s.h3,{id:"-real-time-enforcement",children:"\u2714 Real-time enforcement"}),"\n",(0,i.jsx)(s.h3,{id:"-seamless-integration-with-governance-tools",children:"\u2714 Seamless integration with governance tools"}),"\n",(0,i.jsx)(s.p,{children:"A critical component of any secure Snowflake data platform."}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h1,{id:"-next-topic",children:"\ud83d\udc49 Next Topic"}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Snowflake Costs & Billing Dashboard \u2014 Monitoring Tips"})}),"\n",(0,i.jsx)(s.p,{children:"`"})]})}function h(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,s,n)=>{n.d(s,{R:()=>a,x:()=>c});var l=n(6540);const i={},r=l.createContext(i);function a(e){const s=l.useContext(r);return l.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),l.createElement(r.Provider,{value:s},e.children)}}}]);