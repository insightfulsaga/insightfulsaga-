"use strict";(self.webpackChunkdatacraft_school=self.webpackChunkdatacraft_school||[]).push([[412],{8453:(e,t,r)=>{r.d(t,{R:()=>a,x:()=>l});var n=r(6540);const i={},s=n.createContext(i);function a(e){const t=n.useContext(s);return n.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),n.createElement(s.Provider,{value:t},e.children)}},9487:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>d,contentTitle:()=>l,default:()=>h,frontMatter:()=>a,metadata:()=>n,toc:()=>o});const n=JSON.parse('{"id":"pyspark-filtering","title":"Data Filtering in PySpark DataFrames (Complete Guide with Examples)","description":"Learn how to filter data in PySpark DataFrames using conditions, column expressions, multiple filters, and row extraction with examples and outputs.","source":"@site/docs-pyspark/pyspark-filtering.md","sourceDirName":".","slug":"/pyspark/filtering","permalink":"/pyspark/pyspark/filtering","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"PySpark","permalink":"/pyspark/tags/py-spark"},{"inline":true,"label":"DataFrames","permalink":"/pyspark/tags/data-frames"},{"inline":true,"label":"Filtering","permalink":"/pyspark/tags/filtering"},{"inline":true,"label":"Big Data","permalink":"/pyspark/tags/big-data"}],"version":"current","frontMatter":{"id":"pyspark-filtering","title":"Data Filtering in PySpark DataFrames (Complete Guide with Examples)","sidebar_label":"Data Filtering","slug":"/pyspark/filtering","description":"Learn how to filter data in PySpark DataFrames using conditions, column expressions, multiple filters, and row extraction with examples and outputs.","keywords":["PySpark filtering","PySpark DataFrame filter","filter in PySpark","PySpark select examples","PySpark conditions","big data filtering","PySpark tutorial"],"og:title":"Data Filtering in PySpark DataFrames \u2014 Full Tutorial","og:description":"Step-by-step guide on filtering data in PySpark using expressions, column objects, multiple conditions, and row extraction with real examples.","tags":["PySpark","DataFrames","Filtering","Big Data"]}}');var i=r(4848),s=r(8453);const a={id:"pyspark-filtering",title:"Data Filtering in PySpark DataFrames (Complete Guide with Examples)",sidebar_label:"Data Filtering",slug:"/pyspark/filtering",description:"Learn how to filter data in PySpark DataFrames using conditions, column expressions, multiple filters, and row extraction with examples and outputs.",keywords:["PySpark filtering","PySpark DataFrame filter","filter in PySpark","PySpark select examples","PySpark conditions","big data filtering","PySpark tutorial"],"og:title":"Data Filtering in PySpark DataFrames \u2014 Full Tutorial","og:description":"Step-by-step guide on filtering data in PySpark using expressions, column objects, multiple conditions, and row extraction with real examples.",tags:["PySpark","DataFrames","Filtering","Big Data"]},l="Data Filtering in PySpark DataFrames",d={},o=[{value:"Loading the Data",id:"loading-the-data",level:2},{value:"\ud83d\udccc Why We Need This",id:"-why-we-need-this",level:3},{value:"Preview &amp; Schema",id:"preview--schema",level:2},{value:"Example Output",id:"example-output",level:3},{value:"Schema Output",id:"schema-output",level:3},{value:"1. Filter Orders With <code>total_cost &lt; 500</code>",id:"1-filter-orders-with-total_cost--500",level:2},{value:"\ud83d\udccc Why We Need This",id:"-why-we-need-this-1",level:3},{value:"Output",id:"output",level:3},{value:"2. Select Only Product and Cost (After Filtering)",id:"2-select-only-product-and-cost-after-filtering",level:2},{value:"\ud83d\udccc Why We Need This",id:"-why-we-need-this-2",level:3},{value:"3. Select Using List Syntax",id:"3-select-using-list-syntax",level:2},{value:"4. Filter Using Column Object Expressions",id:"4-filter-using-column-object-expressions",level:2},{value:"\ud83d\udccc Why We Need This",id:"-why-we-need-this-3",level:3},{value:"5. Filtering With Multiple Conditions (AND Logic)",id:"5-filtering-with-multiple-conditions-and-logic",level:2},{value:"\ud83d\udccc Why We Need This",id:"-why-we-need-this-4",level:3},{value:"6. Filter Orders With Status = \u201cPending\u201d",id:"6-filter-orders-with-status--pending",level:2},{value:"\ud83d\udccc Why We Need This",id:"-why-we-need-this-5",level:3},{value:"7. Filter Orders Where Quantity = 10",id:"7-filter-orders-where-quantity--10",level:2},{value:"\ud83d\udccc Why We Need This",id:"-why-we-need-this-6",level:3},{value:"8. Extract Row Data Using <code>.collect()</code> and <code>.asDict()</code>",id:"8-extract-row-data-using-collect-and-asdict",level:2},{value:"Output",id:"output-1",level:3},{value:"\ud83d\udccc Why We Need This",id:"-why-we-need-this-7",level:3}];function c(e){const t={br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.header,{children:(0,i.jsx)(t.h1,{id:"data-filtering-in-pyspark-dataframes",children:"Data Filtering in PySpark DataFrames"})}),"\n",(0,i.jsxs)(t.p,{children:["Filtering is one of the most common and essential operations in PySpark.",(0,i.jsx)(t.br,{}),"\n","It helps you extract relevant subsets of data, apply conditions, perform transformations, and prepare clean datasets for analysis or downstream processing."]}),"\n",(0,i.jsxs)(t.p,{children:["In this guide, you\u2019ll learn ",(0,i.jsx)(t.strong,{children:"all major filtering techniques in PySpark"}),", along with examples, outputs, and explanations."]}),"\n",(0,i.jsx)(t.h2,{id:"loading-the-data",children:"Loading the Data"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-python",children:"from pyspark.sql import SparkSession\r\n\r\n# Start Spark session\r\nspark = SparkSession.builder.appName('ops').getOrCreate()\r\n\r\n# Load the CSV with header and schema inference\r\ndf = spark.read.csv('/path/to/orders.csv', inferSchema=True, header=True)\r\n\n"})}),"\n",(0,i.jsx)(t.h3,{id:"-why-we-need-this",children:"\ud83d\udccc Why We Need This"}),"\n",(0,i.jsx)(t.p,{children:"Data must be loaded into a Spark DataFrame before we can apply filtering, transformations, analytics, or aggregations."}),"\n",(0,i.jsx)(t.h2,{id:"preview--schema",children:"Preview & Schema"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-python",children:"df.show()\n"})}),"\n",(0,i.jsx)(t.h3,{id:"example-output",children:"Example Output"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-text",children:"+--------+----------+-------------+--------+--------------+---------+----------+\r\n|order_id|  product |   category  |quantity|price_per_unit|  status |total_cost|\r\n+--------+----------+-------------+--------+--------------+---------+----------+\r\n|   1001 |    Soap  |Personal Care|   10   |      15      |Delivered|    150   |\r\n|   1002 |  Shampoo |Personal Care|    5   |      60      |Cancelled|    300   |\r\n|   1003 |   Bread  |     Food    |   20   |      10      |Delivered|    200   |\r\n|   1004 |Toothpaste|Personal Care|    7   |      25      | Pending |    175   |\r\n|   1005 |   Rice   |     Food    |   50   |      40      |Delivered|   2000   |\r\n|   1006 |Chocolate |     Food    |   30   |      20      | Pending |    600   |\r\n|   1007 |   Juice  |  Beverages  |   15   |      30      |Delivered|    450   |\r\n|   1008 |  Cereal  |     Food    |   10   |      35      |Delivered|    350   |\r\n|   1009 |   Soda   |  Beverages  |   25   |      25      |Cancelled|    625   |\r\n|   1010 | Facewash |Personal Care|    3   |     120      |Delivered|    360   |\r\n+--------+----------+-------------+--------+--------------+---------+----------+\n"})}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-python",children:"df.printSchema()\n"})}),"\n",(0,i.jsx)(t.h3,{id:"schema-output",children:"Schema Output"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-text",children:"root\r\n |-- order_id: integer (nullable = true)\r\n |-- product: string (nullable = true)\r\n |-- category: string (nullable = true)\r\n |-- quantity: integer (nullable = true)\r\n |-- price_per_unit: integer (nullable = true)\r\n |-- status: string (nullable = true)\r\n |-- total_cost: integer (nullable = true)\n"})}),"\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsx)(t.h1,{id:"filtering-examples-in-pyspark",children:"Filtering Examples in PySpark"}),"\n",(0,i.jsxs)(t.h2,{id:"1-filter-orders-with-total_cost--500",children:["1. Filter Orders With ",(0,i.jsx)(t.code,{children:"total_cost < 500"})]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-python",children:'df.filter("total_cost < 500").show()\n'})}),"\n",(0,i.jsx)(t.h3,{id:"-why-we-need-this-1",children:"\ud83d\udccc Why We Need This"}),"\n",(0,i.jsx)(t.p,{children:"To analyze and work with only the lower-cost orders."}),"\n",(0,i.jsx)(t.h3,{id:"output",children:"Output"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-text",children:"+--------+----------+-------------+--------+--------------+---------+----------+\r\n|order_id|  product |   category  |quantity|price_per_unit|  status |total_cost|\r\n+--------+----------+-------------+--------+--------------+---------+----------+\r\n|   1001 |    Soap  |Personal Care|   10   |      15      |Delivered|    150   |\r\n|   1002 |  Shampoo |Personal Care|    5   |      60      |Cancelled|    300   |\r\n|   1003 |   Bread  |     Food    |   20   |      10      |Delivered|    200   |\r\n|   1004 |Toothpaste|Personal Care|    7   |      25      | Pending |    175   |\r\n|   1007 |   Juice  |  Beverages  |   15   |      30      |Delivered|    450   |\r\n|   1008 |  Cereal  |     Food    |   10   |      35      |Delivered|    350   |\r\n|   1010 | Facewash |Personal Care|    3   |     120      |Delivered|    360   |\r\n+--------+----------+-------------+--------+--------------+---------+----------+\n"})}),"\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsx)(t.h2,{id:"2-select-only-product-and-cost-after-filtering",children:"2. Select Only Product and Cost (After Filtering)"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-python",children:'df.filter("total_cost < 500").select("product", "total_cost").show()\n'})}),"\n",(0,i.jsx)(t.h3,{id:"-why-we-need-this-2",children:"\ud83d\udccc Why We Need This"}),"\n",(0,i.jsx)(t.p,{children:"To extract specific columns after filtering."}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:"+----------+----------+\r\n| product  |total_cost|\r\n+----------+----------+\r\n|   Soap   |    150   |\r\n| Shampoo  |    300   |\r\n| Bread    |    200   |\r\n|Toothpaste|    175   |\r\n|  Juice   |    450   |\r\n|  Cereal  |    350   |\r\n| Facewash |    360   |\r\n+----------+----------+\n"})}),"\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsx)(t.h2,{id:"3-select-using-list-syntax",children:"3. Select Using List Syntax"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-python",children:"df.filter(\"total_cost < 500\").select(['product', 'total_cost']).show()\n"})}),"\n",(0,i.jsx)(t.p,{children:"\ud83d\udccc Useful when you're dynamically passing a list of columns."}),"\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsx)(t.h2,{id:"4-filter-using-column-object-expressions",children:"4. Filter Using Column Object Expressions"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-python",children:"df.filter(df['total_cost'] < 500).select(['product', 'category', 'quantity']).show()\n"})}),"\n",(0,i.jsx)(t.h3,{id:"-why-we-need-this-3",children:"\ud83d\udccc Why We Need This"}),"\n",(0,i.jsx)(t.p,{children:"Cleaner, safer approach than SQL strings \u2014 helps avoid errors in dynamic pipelines."}),"\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsx)(t.h2,{id:"5-filtering-with-multiple-conditions-and-logic",children:"5. Filtering With Multiple Conditions (AND Logic)"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-python",children:"df.filter(\r\n    (df['total_cost'] < 500) & (df['quantity'] > 10)\r\n).show()\n"})}),"\n",(0,i.jsx)(t.h3,{id:"-why-we-need-this-4",children:"\ud83d\udccc Why We Need This"}),"\n",(0,i.jsx)(t.p,{children:"To apply compound filters using multiple conditions."}),"\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsx)(t.h2,{id:"6-filter-orders-with-status--pending",children:"6. Filter Orders With Status = \u201cPending\u201d"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-python",children:"df.filter(df['status'] == 'Pending').show()\n"})}),"\n",(0,i.jsx)(t.h3,{id:"-why-we-need-this-5",children:"\ud83d\udccc Why We Need This"}),"\n",(0,i.jsx)(t.p,{children:"To isolate pending orders for further processing or tracking."}),"\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsx)(t.h2,{id:"7-filter-orders-where-quantity--10",children:"7. Filter Orders Where Quantity = 10"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-python",children:"df.filter(df['quantity'] == 10).show()\n"})}),"\n",(0,i.jsx)(t.h3,{id:"-why-we-need-this-6",children:"\ud83d\udccc Why We Need This"}),"\n",(0,i.jsx)(t.p,{children:"To locate rows matching exact numeric values."}),"\n",(0,i.jsxs)(t.h2,{id:"8-extract-row-data-using-collect-and-asdict",children:["8. Extract Row Data Using ",(0,i.jsx)(t.code,{children:".collect()"})," and ",(0,i.jsx)(t.code,{children:".asDict()"})]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-python",children:"result = df.filter(df['order_id'] == 1003).collect()\r\nrow = result[0]\r\nrow.asDict()\n"})}),"\n",(0,i.jsx)(t.h3,{id:"output-1",children:"Output"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-text",children:"{'order_id': 1003, 'product': 'Bread', 'category': 'Food', \r\n 'quantity': 20, 'price_per_unit': 10, \r\n 'status': 'Delivered', 'total_cost': 200}\n"})}),"\n",(0,i.jsx)(t.p,{children:"Extract a specific field:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-python",children:"row.asDict()['product']\n"})}),"\n",(0,i.jsx)(t.p,{children:"Output:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-text",children:"'Bread'\n"})}),"\n",(0,i.jsx)(t.h3,{id:"-why-we-need-this-7",children:"\ud83d\udccc Why We Need This"}),"\n",(0,i.jsx)(t.p,{children:"To convert Spark data into Python objects for custom logic, API calls, or downstream use."}),"\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsx)(t.h1,{id:"-1-minute-summary--data-filtering-in-pyspark",children:"\ud83d\udd11 1-Minute Summary \u2014 Data Filtering in PySpark"}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Code Example"}),(0,i.jsx)(t.th,{children:"What It Does"}),(0,i.jsx)(t.th,{})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:'df.filter("total_cost < 500")'})}),(0,i.jsx)(t.td,{children:"Filters rows by cost"}),(0,i.jsx)(t.td,{})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:'select("product")'})}),(0,i.jsx)(t.td,{children:"Selects specific columns"}),(0,i.jsx)(t.td,{})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"df['col'] < 500"})}),(0,i.jsx)(t.td,{children:"Condition using column objects"}),(0,i.jsx)(t.td,{})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsxs)(t.td,{children:[(0,i.jsx)(t.code,{children:"&"})," and `"]}),(0,i.jsx)(t.td,{children:"`"}),(0,i.jsx)(t.td,{children:"AND / OR filtering conditions"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"df['status'] == 'Pending'"})}),(0,i.jsx)(t.td,{children:"Filters by category/string"}),(0,i.jsx)(t.td,{})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:".collect()"})}),(0,i.jsx)(t.td,{children:"Returns rows to Python list"}),(0,i.jsx)(t.td,{})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:".asDict()"})}),(0,i.jsx)(t.td,{children:"Converts row to dictionary"}),(0,i.jsx)(t.td,{})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"asDict()['product']"})}),(0,i.jsx)(t.td,{children:"Access single field from row"}),(0,i.jsx)(t.td,{})]})]})]})]})}function h(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}}}]);