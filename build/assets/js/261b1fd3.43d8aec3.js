"use strict";(self.webpackChunkdatacraft_school=self.webpackChunkdatacraft_school||[]).push([[1148],{8453:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>c});var i=s(6540);const r={},l=i.createContext(r);function t(e){const n=i.useContext(l);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),i.createElement(l.Provider,{value:n},e.children)}},8740:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>c,default:()=>u,frontMatter:()=>t,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"databricks-cluster-policies","title":"Cluster Policies \u2014 Cost & Security Enforcement","description":"A story-driven, practical guide on using Databricks Cluster Policies to enforce cost controls, security settings, and standardized configurations for enterprise workloads.","source":"@site/docs-databricks/databricks-cluster-policies.md","sourceDirName":".","slug":"/databricks-cluster-policies","permalink":"/databricks/databricks-cluster-policies","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"databricks-cluster-policies","title":"Cluster Policies \u2014 Cost & Security Enforcement","sidebar_label":"Cluster Policies","description":"A story-driven, practical guide on using Databricks Cluster Policies to enforce cost controls, security settings, and standardized configurations for enterprise workloads.","keywords":["databricks cluster policies","databricks cost control","databricks cluster security","databricks governance","databricks enterprise clusters","databricks policy enforcement"]},"sidebar":"tutorialSidebar2","previous":{"title":"Alerts (Email & Slack)","permalink":"/databricks/databricks-alerts-email-slack"},"next":{"title":"Repos & CI/CD","permalink":"/databricks/databricks-repos-ci-cd"}}');var r=s(4848),l=s(8453);const t={id:"databricks-cluster-policies",title:"Cluster Policies \u2014 Cost & Security Enforcement",sidebar_label:"Cluster Policies",description:"A story-driven, practical guide on using Databricks Cluster Policies to enforce cost controls, security settings, and standardized configurations for enterprise workloads.",keywords:["databricks cluster policies","databricks cost control","databricks cluster security","databricks governance","databricks enterprise clusters","databricks policy enforcement"]},c="Cluster Policies \u2014 Cost & Security Enforcement",o={},a=[{value:"\ud83c\udfac Story Time \u2014 \u201cClusters Out of Control\u201d",id:"-story-time--clusters-out-of-control",level:2},{value:"\ud83d\udd25 1. What Are Cluster Policies?",id:"-1-what-are-cluster-policies",level:2},{value:"\ud83e\uddf1 2. Why Cluster Policies Matter",id:"-2-why-cluster-policies-matter",level:2},{value:"Cost Control",id:"cost-control",level:3},{value:"Security &amp; Compliance",id:"security--compliance",level:3},{value:"Standardization",id:"standardization",level:3},{value:"\u2699\ufe0f 3. Creating a Cluster Policy",id:"\ufe0f-3-creating-a-cluster-policy",level:2},{value:"\ud83e\uddea 4. Example Use Cases",id:"-4-example-use-cases",level:2},{value:"\u2705 Cost Control for ETL Pipelines",id:"-cost-control-for-etl-pipelines",level:3},{value:"\u2705 Security for Sensitive Data",id:"-security-for-sensitive-data",level:3},{value:"\u2705 Standardization Across Teams",id:"-standardization-across-teams",level:3},{value:"\ud83d\udd04 5. Advanced Policy Rules",id:"-5-advanced-policy-rules",level:2},{value:"\ud83d\udee1\ufe0f 6. Real-World Story \u2014 Priya\u2019s Success",id:"\ufe0f-6-real-world-story--priyas-success",level:2},{value:"\ud83e\udde0 Best Practices",id:"-best-practices",level:2},{value:"\ud83d\udcd8 Summary",id:"-summary",level:2}];function d(e){const n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"cluster-policies--cost--security-enforcement",children:"Cluster Policies \u2014 Cost & Security Enforcement"})}),"\n",(0,r.jsx)(n.h2,{id:"-story-time--clusters-out-of-control",children:"\ud83c\udfac Story Time \u2014 \u201cClusters Out of Control\u201d"}),"\n",(0,r.jsx)(n.p,{children:"Priya, a data engineering manager, notices the company\u2019s Databricks costs skyrocketing:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Multiple large clusters running overnight"}),"\n",(0,r.jsx)(n.li,{children:"Developers creating expensive GPU clusters for simple ETL"}),"\n",(0,r.jsx)(n.li,{children:"Misconfigured clusters with weak security settings"}),"\n"]}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"\u201cWe need control without slowing down our team,\u201d she thinks."}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["Enter ",(0,r.jsx)(n.strong,{children:"Databricks Cluster Policies"})," \u2014 the tool that balances ",(0,r.jsx)(n.strong,{children:"governance, cost, and security"}),"."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"-1-what-are-cluster-policies",children:"\ud83d\udd25 1. What Are Cluster Policies?"}),"\n",(0,r.jsx)(n.p,{children:"Cluster Policies allow admins to:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Enforce rules for all clusters"}),"\n",(0,r.jsx)(n.li,{children:"Restrict instance types"}),"\n",(0,r.jsx)(n.li,{children:"Set minimum/maximum node counts"}),"\n",(0,r.jsx)(n.li,{children:"Control auto-termination timers"}),"\n",(0,r.jsx)(n.li,{children:"Restrict access to sensitive network/security configurations"}),"\n",(0,r.jsx)(n.li,{children:"Apply governance without blocking developers"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["Essentially, ",(0,r.jsx)(n.strong,{children:"control the environment without slowing down innovation"}),"."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"-2-why-cluster-policies-matter",children:"\ud83e\uddf1 2. Why Cluster Policies Matter"}),"\n",(0,r.jsx)(n.h3,{id:"cost-control",children:"Cost Control"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Prevent large, expensive clusters"}),"\n",(0,r.jsx)(n.li,{children:"Enforce auto-termination"}),"\n",(0,r.jsx)(n.li,{children:"Limit GPU usage to approved projects"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"security--compliance",children:"Security & Compliance"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Enforce secure cluster configurations"}),"\n",(0,r.jsx)(n.li,{children:"Control IAM roles & credential passthrough"}),"\n",(0,r.jsx)(n.li,{children:"Prevent risky network settings"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"standardization",children:"Standardization"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Maintain cluster consistency across teams"}),"\n",(0,r.jsx)(n.li,{children:"Reduce debugging caused by misconfigured clusters"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"\ufe0f-3-creating-a-cluster-policy",children:"\u2699\ufe0f 3. Creating a Cluster Policy"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Go to ",(0,r.jsx)(n.strong,{children:"Admin Console \u2192 Cluster Policies \u2192 Create Policy"})]}),"\n",(0,r.jsxs)(n.li,{children:["Define ",(0,r.jsx)(n.strong,{children:"policy name"}),": ",(0,r.jsx)(n.code,{children:"ETL_Default_Policy"})]}),"\n",(0,r.jsx)(n.li,{children:"Set rules:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\r\n  "num_workers": {\r\n    "type": "range",\r\n    "minValue": 2,\r\n    "maxValue": 8,\r\n    "defaultValue": 4\r\n  },\r\n  "spark_version": {\r\n    "type": "fixed",\r\n    "value": "13.2.x-scala2.12"\r\n  },\r\n  "node_type_id": {\r\n    "type": "allowed",\r\n    "values": ["Standard_DS3_v2", "Standard_DS4_v2"],\r\n    "defaultValue": "Standard_DS3_v2"\r\n  },\r\n  "autotermination_minutes": {\r\n    "type": "fixed",\r\n    "value": 60\r\n  }\r\n}\n'})}),"\n",(0,r.jsxs)(n.ol,{start:"4",children:["\n",(0,r.jsx)(n.li,{children:"Assign policy to users/groups"}),"\n",(0,r.jsx)(n.li,{children:"Users creating clusters must now comply with the policy"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"-4-example-use-cases",children:"\ud83e\uddea 4. Example Use Cases"}),"\n",(0,r.jsx)(n.h3,{id:"-cost-control-for-etl-pipelines",children:"\u2705 Cost Control for ETL Pipelines"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Limit worker nodes"}),"\n",(0,r.jsx)(n.li,{children:"Restrict expensive instances"}),"\n",(0,r.jsx)(n.li,{children:"Enforce 30-minute auto-termination"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"-security-for-sensitive-data",children:"\u2705 Security for Sensitive Data"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Enforce credential passthrough"}),"\n",(0,r.jsx)(n.li,{children:"Restrict public network access"}),"\n",(0,r.jsx)(n.li,{children:"Prevent elevated IAM roles"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"-standardization-across-teams",children:"\u2705 Standardization Across Teams"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Same Spark version across dev, QA, and prod"}),"\n",(0,r.jsx)(n.li,{children:"Consistent logging & monitoring configurations"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"-5-advanced-policy-rules",children:"\ud83d\udd04 5. Advanced Policy Rules"}),"\n",(0,r.jsx)(n.p,{children:"Cluster policies support:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Conditional rules"})," based on user groups"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Dynamic defaults"})," depending on workload type"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Regex validation"})," for cluster names"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Enforcing init scripts"})," for compliance or monitoring"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Example:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\r\n  "cluster_name": {\r\n    "type": "regex",\r\n    "pattern": "^(etl|ml|analytics)-.*$"\r\n  }\r\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:"All clusters must now follow naming conventions."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"\ufe0f-6-real-world-story--priyas-success",children:"\ud83d\udee1\ufe0f 6. Real-World Story \u2014 Priya\u2019s Success"}),"\n",(0,r.jsx)(n.p,{children:"Before policies:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"50 clusters running every night"}),"\n",(0,r.jsx)(n.li,{children:"Cost: $25k/month"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["After applying ",(0,r.jsx)(n.strong,{children:"Cluster Policies"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Unapproved instance types blocked"}),"\n",(0,r.jsx)(n.li,{children:"Auto-termination enforced"}),"\n",(0,r.jsx)(n.li,{children:"Standardized Spark version applied"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Result:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Cost dropped 35%"}),"\n",(0,r.jsx)(n.li,{children:"Security compliance ensured"}),"\n",(0,r.jsx)(n.li,{children:"Developers could still create clusters without waiting for approvals"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Priya smiles:"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"\u201cWe have control and agility \u2014 finally!\u201d"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"-best-practices",children:"\ud83e\udde0 Best Practices"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Start with ",(0,r.jsx)(n.strong,{children:"lightweight policies"}),", then tighten gradually"]}),"\n",(0,r.jsxs)(n.li,{children:["Apply policies ",(0,r.jsx)(n.strong,{children:"per user group or workspace"})]}),"\n",(0,r.jsxs)(n.li,{children:["Enforce ",(0,r.jsx)(n.strong,{children:"auto-termination"})," to control idle cost"]}),"\n",(0,r.jsxs)(n.li,{children:["Standardize ",(0,r.jsx)(n.strong,{children:"Spark versions and node types"})]}),"\n",(0,r.jsxs)(n.li,{children:["Use ",(0,r.jsx)(n.strong,{children:"init scripts"})," for monitoring or compliance"]}),"\n",(0,r.jsx)(n.li,{children:"Audit cluster creation and failures"}),"\n",(0,r.jsx)(n.li,{children:"Communicate policy changes to teams"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"-summary",children:"\ud83d\udcd8 Summary"}),"\n",(0,r.jsx)(n.p,{children:"Databricks Cluster Policies enable:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"\u2714 Cost governance"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"\u2714 Security enforcement"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"\u2714 Standardized cluster configurations"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"\u2714 Reduced idle compute costs"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"\u2714 Compliance with enterprise regulations"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["A must-have tool for ",(0,r.jsx)(n.strong,{children:"enterprise-scale Databricks deployments"}),"."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h1,{id:"-next-topic",children:"\ud83d\udc49 Next Topic"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Repos & CI/CD \u2014 Git Integration and Code Promotion"})})]})}function u(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}}}]);