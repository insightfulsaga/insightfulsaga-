"use strict";(self.webpackChunkdatacraft_school=self.webpackChunkdatacraft_school||[]).push([[9181],{770:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>o,default:()=>h,frontMatter:()=>t,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"databricks-cluster-sizing","title":"Cluster Sizing \u2014 Choosing the Right Instance Type in Databricks","description":"Learn how to choose the right Databricks cluster size, instance type, worker configuration, and autoscaling strategy with an easy, story-driven explanation.","source":"@site/docs-databricks/databricks-cluster-sizing.md","sourceDirName":".","slug":"/databricks-cluster-sizing","permalink":"/databricks/databricks-cluster-sizing","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"databricks-cluster-sizing","title":"Cluster Sizing \u2014 Choosing the Right Instance Type in Databricks","sidebar_label":"Cluster Sizing","description":"Learn how to choose the right Databricks cluster size, instance type, worker configuration, and autoscaling strategy with an easy, story-driven explanation.","keywords":["Databricks cluster sizing","Databricks instance types","Databricks best practices","autoscaling clusters","Databricks performance tuning"]},"sidebar":"tutorialSidebar2","previous":{"title":"Photon Engine","permalink":"/databricks/databricks-photon-engine"},"next":{"title":"SQL Endpoint Tuning","permalink":"/databricks/databricks-sql-endpoint-tuning"}}');var r=s(4848),l=s(8453);const t={id:"databricks-cluster-sizing",title:"Cluster Sizing \u2014 Choosing the Right Instance Type in Databricks",sidebar_label:"Cluster Sizing",description:"Learn how to choose the right Databricks cluster size, instance type, worker configuration, and autoscaling strategy with an easy, story-driven explanation.",keywords:["Databricks cluster sizing","Databricks instance types","Databricks best practices","autoscaling clusters","Databricks performance tuning"]},o="Cluster Sizing \u2014 Choosing the Right Instance Type",a={},c=[{value:"\u2728 Story Time \u2014 \u201cWhy Is This Pipeline So Expensive?\u201d",id:"-story-time--why-is-this-pipeline-so-expensive",level:2},{value:"\ud83e\udde9 What Is Cluster Sizing?",id:"-what-is-cluster-sizing",level:2},{value:"\ud83c\udfd7\ufe0f Types of Databricks Cluster Nodes",id:"\ufe0f-types-of-databricks-cluster-nodes",level:2},{value:"<strong>1. General Purpose (Balanced)</strong>",id:"1-general-purpose-balanced",level:3},{value:"<strong>2. Compute-Optimized</strong>",id:"2-compute-optimized",level:3},{value:"<strong>3. Memory-Optimized</strong>",id:"3-memory-optimized",level:3},{value:"<strong>4. Storage-Optimized</strong>",id:"4-storage-optimized",level:3},{value:"<strong>5. GPU Nodes</strong>",id:"5-gpu-nodes",level:3},{value:"\ud83d\ude80 Choosing Worker Count",id:"-choosing-worker-count",level:2},{value:"\ud83d\udd04 Autoscaling Best Practices",id:"-autoscaling-best-practices",level:2},{value:"\ud83d\udfe9 Enable autoscaling",id:"-enable-autoscaling",level:3},{value:"\ud83d\udfe9 Keep min nodes small",id:"-keep-min-nodes-small",level:3},{value:"\ud83d\udfe9 Keep max nodes reasonable",id:"-keep-max-nodes-reasonable",level:3},{value:"\ud83d\udfe9 Use Enhanced Autoscaling",id:"-use-enhanced-autoscaling",level:3},{value:"\ud83e\uddea Real-World Example \u2014 Cost Saved by 40%",id:"-real-world-example--cost-saved-by-40",level:2},{value:"\ud83d\udce6 Cluster Sizing Checklist",id:"-cluster-sizing-checklist",level:2},{value:"\ud83d\udfe9 1. What type of workload?",id:"-1-what-type-of-workload",level:3},{value:"\ud83d\udfe9 2. How much data?",id:"-2-how-much-data",level:3},{value:"\ud83d\udfe9 3. How much shuffling?",id:"-3-how-much-shuffling",level:3},{value:"\ud83d\udfe9 4. Does caching matter?",id:"-4-does-caching-matter",level:3},{value:"\ud83d\udfe9 5. Use spot instances for non-critical jobs",id:"-5-use-spot-instances-for-non-critical-jobs",level:3},{value:"\ud83c\udfaf Best Practices for Cluster Sizing",id:"-best-practices-for-cluster-sizing",level:2},{value:"\ud83d\udcd8 Summary",id:"-summary",level:2}];function d(e){const n={blockquote:"blockquote",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"cluster-sizing--choosing-the-right-instance-type",children:"Cluster Sizing \u2014 Choosing the Right Instance Type"})}),"\n",(0,r.jsx)(n.h2,{id:"-story-time--why-is-this-pipeline-so-expensive",children:"\u2728 Story Time \u2014 \u201cWhy Is This Pipeline So Expensive?\u201d"}),"\n",(0,r.jsx)(n.p,{children:"Sara is a data engineer managing multiple ETL pipelines:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Some jobs run slow"}),"\n",(0,r.jsx)(n.li,{children:"Some jobs fail randomly"}),"\n",(0,r.jsx)(n.li,{children:"Some cost too much"}),"\n",(0,r.jsx)(n.li,{children:"Analysts complain about dashboards being stuck"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"The CTO walks by:"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["\u201cSara, our cloud bill looks\u2026 scary.",(0,r.jsx)(n.br,{}),"\n","Can we optimize our clusters?\u201d"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["Sara nods.",(0,r.jsx)(n.br,{}),"\n","Cluster sizing isn\u2019t just about performance \u2014",(0,r.jsx)(n.br,{}),"\n","It\u2019s about ",(0,r.jsx)(n.strong,{children:"speed + stability + cost-efficiency"})," all working together."]}),"\n",(0,r.jsxs)(n.p,{children:["And Databricks gives you dozens of instance types\u2026",(0,r.jsx)(n.br,{}),"\n","Which one is the right choice?"]}),"\n",(0,r.jsx)(n.p,{children:"Let\u2019s simplify this."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"-what-is-cluster-sizing",children:"\ud83e\udde9 What Is Cluster Sizing?"}),"\n",(0,r.jsx)(n.p,{children:"Cluster sizing is the process of choosing:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Node type (compute-optimized, memory-optimized, GPU, etc.)"}),"\n",(0,r.jsx)(n.li,{children:"Number of workers"}),"\n",(0,r.jsx)(n.li,{children:"Driver size"}),"\n",(0,r.jsx)(n.li,{children:"Autoscaling configuration"}),"\n",(0,r.jsx)(n.li,{children:"Spot vs On-demand nodes"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Your choices directly impact:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Cost"}),"\n",(0,r.jsx)(n.li,{children:"Performance"}),"\n",(0,r.jsx)(n.li,{children:"Stability"}),"\n",(0,r.jsx)(n.li,{children:"Job success rate"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["Choosing the wrong cluster = Slow + Expensive.",(0,r.jsx)(n.br,{}),"\n","Choosing the right cluster = Fast + Cheap."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"\ufe0f-types-of-databricks-cluster-nodes",children:"\ud83c\udfd7\ufe0f Types of Databricks Cluster Nodes"}),"\n",(0,r.jsx)(n.h3,{id:"1-general-purpose-balanced",children:(0,r.jsx)(n.strong,{children:"1. General Purpose (Balanced)"})}),"\n",(0,r.jsx)(n.p,{children:"Use when you don\u2019t know what to choose."}),"\n",(0,r.jsx)(n.p,{children:"Great for:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Medium ETL jobs"}),"\n",(0,r.jsx)(n.li,{children:"Not-too-heavy SQL queries"}),"\n",(0,r.jsx)(n.li,{children:"Mixed workloads"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Examples:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"m5.xlarge"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"m5.2xlarge"})}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"2-compute-optimized",children:(0,r.jsx)(n.strong,{children:"2. Compute-Optimized"})}),"\n",(0,r.jsx)(n.p,{children:"High CPU power \u2014 great for parallel workloads."}),"\n",(0,r.jsx)(n.p,{children:"Best for:"}),"\n",(0,r.jsxs)(n.p,{children:["\u2714 Photon workloads",(0,r.jsx)(n.br,{}),"\n","\u2714 SQL-heavy jobs",(0,r.jsx)(n.br,{}),"\n","\u2714 Aggregations & group-bys",(0,r.jsx)(n.br,{}),"\n","\u2714 BI dashboards"]}),"\n",(0,r.jsx)(n.p,{children:"Examples:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"c5.xlarge"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"c5.2xlarge"})}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"3-memory-optimized",children:(0,r.jsx)(n.strong,{children:"3. Memory-Optimized"})}),"\n",(0,r.jsx)(n.p,{children:"High RAM \u2014 great for large joins & heavy shuffle."}),"\n",(0,r.jsx)(n.p,{children:"Best for:"}),"\n",(0,r.jsxs)(n.p,{children:["\u2714 ETL pipelines",(0,r.jsx)(n.br,{}),"\n","\u2714 machine learning feature joins",(0,r.jsx)(n.br,{}),"\n","\u2714 caching large datasets"]}),"\n",(0,r.jsx)(n.p,{children:"Examples:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"r5.xlarge"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"r5.4xlarge"})}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"4-storage-optimized",children:(0,r.jsx)(n.strong,{children:"4. Storage-Optimized"})}),"\n",(0,r.jsxs)(n.p,{children:["Useful when you need ",(0,r.jsx)(n.strong,{children:"fast local disk"})," \u2014 e.g., Delta caching."]}),"\n",(0,r.jsx)(n.p,{children:"Best for:"}),"\n",(0,r.jsxs)(n.p,{children:["\u2714 Photon",(0,r.jsx)(n.br,{}),"\n","\u2714 Data skipping workloads",(0,r.jsx)(n.br,{}),"\n","\u2714 Large Delta tables"]}),"\n",(0,r.jsx)(n.p,{children:"Examples:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"i3.xlarge"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"i3en.2xlarge"})}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"5-gpu-nodes",children:(0,r.jsx)(n.strong,{children:"5. GPU Nodes"})}),"\n",(0,r.jsx)(n.p,{children:"Best for ML training & deep learning, not SQL/ETL."}),"\n",(0,r.jsx)(n.p,{children:"Examples:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"p3.2xlarge"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"g4dn.xlarge"})}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"-choosing-worker-count",children:"\ud83d\ude80 Choosing Worker Count"}),"\n",(0,r.jsx)(n.p,{children:"A common mistake:"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"Choosing too many or too few workers."}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"General rule:"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Data Volume"}),(0,r.jsx)(n.th,{children:"Recommended Workers"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"< 50 GB"}),(0,r.jsx)(n.td,{children:"2\u20134 workers"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"50\u2013500 GB"}),(0,r.jsx)(n.td,{children:"4\u20138 workers"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"500GB \u2013 2TB"}),(0,r.jsx)(n.td,{children:"8\u201316 workers"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"2TB+"}),(0,r.jsx)(n.td,{children:"16\u201332 workers"})]})]})]}),"\n",(0,r.jsx)(n.p,{children:"Always start small \u2192 scale up only if needed."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"-autoscaling-best-practices",children:"\ud83d\udd04 Autoscaling Best Practices"}),"\n",(0,r.jsx)(n.h3,{id:"-enable-autoscaling",children:"\ud83d\udfe9 Enable autoscaling"}),"\n",(0,r.jsx)(n.p,{children:"It saves cost by dynamically adjusting cluster size."}),"\n",(0,r.jsx)(n.h3,{id:"-keep-min-nodes-small",children:"\ud83d\udfe9 Keep min nodes small"}),"\n",(0,r.jsx)(n.p,{children:"Avoid paying for idle nodes."}),"\n",(0,r.jsx)(n.h3,{id:"-keep-max-nodes-reasonable",children:"\ud83d\udfe9 Keep max nodes reasonable"}),"\n",(0,r.jsx)(n.p,{children:"Prevent runaway scaling."}),"\n",(0,r.jsx)(n.p,{children:"Example:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-text",children:"Min Workers: 2\r\nMax Workers: 10\n"})}),"\n",(0,r.jsx)(n.h3,{id:"-use-enhanced-autoscaling",children:"\ud83d\udfe9 Use Enhanced Autoscaling"}),"\n",(0,r.jsx)(n.p,{children:"Better for bursty and unpredictable workloads."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"-real-world-example--cost-saved-by-40",children:"\ud83e\uddea Real-World Example \u2014 Cost Saved by 40%"}),"\n",(0,r.jsx)(n.p,{children:"Sara\u2019s ETL pipeline was running on:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"32 workers"}),"\n",(0,r.jsx)(n.li,{children:"r5.8xlarge (huge & expensive)"}),"\n",(0,r.jsx)(n.li,{children:"No autoscaling"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["Cost was ",(0,r.jsx)(n.strong,{children:"$120/hour"})," for a single daily job."]}),"\n",(0,r.jsx)(n.p,{children:"After right-sizing:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"8 workers"}),"\n",(0,r.jsx)(n.li,{children:"c5.2xlarge (cheaper & faster for SQL)"}),"\n",(0,r.jsx)(n.li,{children:"Autoscaling 4 \u2192 12"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["New cost: ",(0,r.jsx)(n.strong,{children:"$72/hour"}),"\r\nPerformance: 30% faster\r\nStability: Improved dramatically"]}),"\n",(0,r.jsx)(n.p,{children:"Right sizing = $$$ saved + faster jobs."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"-cluster-sizing-checklist",children:"\ud83d\udce6 Cluster Sizing Checklist"}),"\n",(0,r.jsx)(n.h3,{id:"-1-what-type-of-workload",children:"\ud83d\udfe9 1. What type of workload?"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Workload"}),(0,r.jsx)(n.th,{children:"Best Node Type"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"SQL / BI"}),(0,r.jsx)(n.td,{children:"Compute-optimized or Photon"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"ETL"}),(0,r.jsx)(n.td,{children:"General-purpose or memory-optimized"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"ML Training"}),(0,r.jsx)(n.td,{children:"GPU"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Delta-heavy"}),(0,r.jsx)(n.td,{children:"Storage-optimized"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"-2-how-much-data",children:"\ud83d\udfe9 2. How much data?"}),"\n",(0,r.jsx)(n.p,{children:"Size workers based on volume."}),"\n",(0,r.jsx)(n.h3,{id:"-3-how-much-shuffling",children:"\ud83d\udfe9 3. How much shuffling?"}),"\n",(0,r.jsx)(n.p,{children:"More shuffle = more memory needed."}),"\n",(0,r.jsx)(n.h3,{id:"-4-does-caching-matter",children:"\ud83d\udfe9 4. Does caching matter?"}),"\n",(0,r.jsxs)(n.p,{children:["Use ",(0,r.jsx)(n.strong,{children:"i3 / i3en"})," for fast SSD local caching."]}),"\n",(0,r.jsx)(n.h3,{id:"-5-use-spot-instances-for-non-critical-jobs",children:"\ud83d\udfe9 5. Use spot instances for non-critical jobs"}),"\n",(0,r.jsx)(n.p,{children:"Spot = cheap\r\nOn-demand = reliable"}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"-best-practices-for-cluster-sizing",children:"\ud83c\udfaf Best Practices for Cluster Sizing"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Don\u2019t oversize \u2014 start small and scale."}),"\n",(0,r.jsx)(n.li,{children:"Use Photon for SQL-intensive workloads."}),"\n",(0,r.jsx)(n.li,{children:"Enable autoscaling."}),"\n",(0,r.jsx)(n.li,{children:"Use spot workers for non-critical pipelines."}),"\n",(0,r.jsx)(n.li,{children:"Avoid GPU nodes unless doing ML."}),"\n",(0,r.jsx)(n.li,{children:"Cache hot data only when useful."}),"\n",(0,r.jsx)(n.li,{children:"Consider job clusters for ETL pipelines."}),"\n",(0,r.jsxs)(n.li,{children:["For production SQL dashboards \u2192 use ",(0,r.jsx)(n.strong,{children:"Databricks SQL Warehouses"}),", not clusters."]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"-summary",children:"\ud83d\udcd8 Summary"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Cluster sizing is essential for balancing speed, cost, and reliability."}),"\n",(0,r.jsx)(n.li,{children:"Databricks offers multiple node types \u2014 choose based on workload."}),"\n",(0,r.jsx)(n.li,{children:"Autoscaling and Photon can significantly improve efficiency."}),"\n",(0,r.jsx)(n.li,{children:"Right-sized clusters reduce cost and increase performance."}),"\n",(0,r.jsx)(n.li,{children:"Understanding your data volume and query patterns is the key to picking the right instance."}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Choose smart clusters \u2192 save money \u2192 boost performance \u2192 make your team happy."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h1,{id:"-next-topic",children:"\ud83d\udc49 Next Topic"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"SQL Endpoint Tuning \u2014 Query Performance Optimization"})})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>o});var i=s(6540);const r={},l=i.createContext(r);function t(e){const n=i.useContext(l);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),i.createElement(l.Provider,{value:n},e.children)}}}]);