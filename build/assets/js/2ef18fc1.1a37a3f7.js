"use strict";(self.webpackChunkdatacraft_school=self.webpackChunkdatacraft_school||[]).push([[7005],{4816:(e,r,s)=>{s.r(r),s.d(r,{assets:()=>c,contentTitle:()=>a,default:()=>o,frontMatter:()=>d,metadata:()=>n,toc:()=>l});const n=JSON.parse('{"id":"house-price-linear-regression","title":"Predict House Price with Linear Regression","description":"Learn how to predict house prices using PySpark Linear Regression, step-by-step.","source":"@site/docs-pyspark/house-price-linear-regression.md","sourceDirName":".","slug":"/house-price-linear-regression","permalink":"/pyspark/house-price-linear-regression","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"house-price-linear-regression","title":"Predict House Price with Linear Regression","sidebar_label":"House Price Prediction - Linear Regressing","description":"Learn how to predict house prices using PySpark Linear Regression, step-by-step."}}');var i=s(4848),t=s(8453);const d={id:"house-price-linear-regression",title:"Predict House Price with Linear Regression",sidebar_label:"House Price Prediction - Linear Regressing",description:"Learn how to predict house prices using PySpark Linear Regression, step-by-step."},a="\ud83c\udfe0 Predicting House Price from Size Using Linear Regression (PySpark)",c={},l=[{value:"\ud83d\udcca Example Dataset",id:"-example-dataset",level:2},{value:"\u2705 Step 1: Import Libraries &amp; Create Data",id:"-step-1-import-libraries--create-data",level:2},{value:"\u2705 Step 2: Assemble Features",id:"-step-2-assemble-features",level:2},{value:"\u2705 Step 3: Train the Linear Regression Model",id:"-step-3-train-the-linear-regression-model",level:2},{value:"\u2705 Step 4: See What the Model Learned",id:"-step-4-see-what-the-model-learned",level:2},{value:"\u2705 Step 5: Check Model Performance",id:"-step-5-check-model-performance",level:2},{value:"\u2705 Step 6: Make Predictions on Training Data",id:"-step-6-make-predictions-on-training-data",level:2},{value:"\u2705 Step 7: Predict New (Unseen) Data",id:"-step-7-predict-new-unseen-data",level:2},{value:"\ud83d\udd11 1-Minute Summary - Predict House Price with Linear Regression",id:"-1-minute-summary---predict-house-price-with-linear-regression",level:2}];function h(e){const r={blockquote:"blockquote",br:"br",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.header,{children:(0,i.jsx)(r.h1,{id:"-predicting-house-price-from-size-using-linear-regression-pyspark",children:"\ud83c\udfe0 Predicting House Price from Size Using Linear Regression (PySpark)"})}),"\n",(0,i.jsxs)(r.p,{children:["Let\u2019s say you're working with a real estate startup.",(0,i.jsx)(r.br,{}),"\n","They ask:"]}),"\n",(0,i.jsxs)(r.blockquote,{children:["\n",(0,i.jsx)(r.p,{children:'\ud83d\udcac "Can we estimate a house\u2019s price based on its size in square feet?"'}),"\n"]}),"\n",(0,i.jsxs)(r.p,{children:["That\u2019s a ",(0,i.jsx)(r.strong,{children:"regression problem"})," \u2014 predicting a continuous number (like price).",(0,i.jsx)(r.br,{}),"\n","We\u2019ll use ",(0,i.jsx)(r.strong,{children:"Linear Regression"})," to do that."]}),"\n",(0,i.jsx)(r.h2,{id:"-example-dataset",children:"\ud83d\udcca Example Dataset"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-text",children:"| Size (sq.ft) | Price ($1000s) |\r\n|--------------|----------------|\r\n| 850          | 100            |\r\n| 900          | 120            |\r\n| 1000         | 150            |\r\n| 1200         | 200            |\r\n| 1500         | 250            |\n"})}),"\n",(0,i.jsx)(r.h2,{id:"-step-1-import-libraries--create-data",children:"\u2705 Step 1: Import Libraries & Create Data"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-python",children:'from pyspark.sql import SparkSession\r\nfrom pyspark.ml.regression import LinearRegression\r\nfrom pyspark.ml.feature import VectorAssembler\r\n\r\n# Start Spark session\r\nspark = SparkSession.builder.appName("LinearRegressionExample").getOrCreate()\r\n\r\n# Create dataset (size, price)\r\ndata = [\r\n    (850, 100),\r\n    (900, 120),\r\n    (1000, 150),\r\n    (1200, 200),\r\n    (1500, 250)\r\n]\r\n\r\ndf = spark.createDataFrame(data, ["size", "price"])\r\ndf.show()\n'})}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.strong,{children:"\ud83d\udca1 What This Does:"})}),"\n",(0,i.jsxs)(r.table,{children:[(0,i.jsx)(r.thead,{children:(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.th,{children:"Line"}),(0,i.jsx)(r.th,{children:"Meaning"})]})}),(0,i.jsxs)(r.tbody,{children:[(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"SparkSession"})}),(0,i.jsx)(r.td,{children:"Starts Spark (needed for all PySpark work)"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"createDataFrame(data, columns)"})}),(0,i.jsxs)(r.td,{children:["Creates a DataFrame (like a table) with columns ",(0,i.jsx)(r.code,{children:"size"})," and ",(0,i.jsx)(r.code,{children:"price"})]})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"df.show()"})}),(0,i.jsx)(r.td,{children:"Prints the data table"})]})]})]}),"\n",(0,i.jsx)(r.h2,{id:"-step-2-assemble-features",children:"\u2705 Step 2: Assemble Features"}),"\n",(0,i.jsx)(r.p,{children:"Spark ML expects features in a single vector column."}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-python",children:'assembler = VectorAssembler(inputCols=["size"], outputCol="features")\r\ndf_features = assembler.transform(df).select("features", "price")\r\ndf_features.show(truncate=False)\n'})}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.strong,{children:"\ud83d\udca1 What This Does:"})}),"\n",(0,i.jsxs)(r.table,{children:[(0,i.jsx)(r.thead,{children:(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.th,{children:"Line"}),(0,i.jsx)(r.th,{children:"Meaning"})]})}),(0,i.jsxs)(r.tbody,{children:[(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"VectorAssembler(...)"})}),(0,i.jsxs)(r.td,{children:['Converts "size" column into a ',(0,i.jsx)(r.code,{children:"features"})," vector (needed by Spark ML)"]})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"transform(df)"})}),(0,i.jsx)(r.td,{children:"Applies the assembler to your DataFrame"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:'select("features", "price")'})}),(0,i.jsxs)(r.td,{children:["Keeps only the ",(0,i.jsx)(r.code,{children:"features"})," and ",(0,i.jsx)(r.code,{children:"price"})," columns"]})]})]})]}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.strong,{children:"Result"})}),"\n",(0,i.jsxs)(r.table,{children:[(0,i.jsx)(r.thead,{children:(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.th,{children:"features"}),(0,i.jsx)(r.th,{children:"price"})]})}),(0,i.jsxs)(r.tbody,{children:[(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"[850.0]"}),(0,i.jsx)(r.td,{children:"100"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"[900.0]"}),(0,i.jsx)(r.td,{children:"120"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"[1000.0]"}),(0,i.jsx)(r.td,{children:"150"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"[1200.0]"}),(0,i.jsx)(r.td,{children:"200"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"[1500.0]"}),(0,i.jsx)(r.td,{children:"250"})]})]})]}),"\n",(0,i.jsx)(r.h2,{id:"-step-3-train-the-linear-regression-model",children:"\u2705 Step 3: Train the Linear Regression Model"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-python",children:'lr = LinearRegression(featuresCol="features", labelCol="price")\r\nmodel = lr.fit(df_features)\n'})}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.strong,{children:"\ud83d\udca1 What This Does:"})}),"\n",(0,i.jsxs)(r.table,{children:[(0,i.jsx)(r.thead,{children:(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.th,{children:"Line"}),(0,i.jsx)(r.th,{children:"Meaning"})]})}),(0,i.jsxs)(r.tbody,{children:[(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"LinearRegression(...)"})}),(0,i.jsx)(r.td,{children:"Creates the model and tells it which column is the feature and label"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"model = lr.fit(df_features)"})}),(0,i.jsx)(r.td,{children:"Trains (fits) the model using your data"})]})]})]}),"\n",(0,i.jsx)(r.h2,{id:"-step-4-see-what-the-model-learned",children:"\u2705 Step 4: See What the Model Learned"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-python",children:'print("Coefficient (w):", model.coefficients)\r\nprint("Intercept (b):", model.intercept)\n'})}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.strong,{children:"Result"})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-python",children:"Coefficient (w): [0.2]\r\nIntercept (b): -70.0\n"})}),"\n",(0,i.jsx)(r.p,{children:"This means your learned equation is:"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-text",children:"price = 0.2 \xd7 size - 70\n"})}),"\n",(0,i.jsx)(r.p,{children:"\ud83d\udc49 So a 1000 sq.ft house would be:"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-text",children:"price = 0.2 \xd7 1000 - 70 = $130k\n"})}),"\n",(0,i.jsx)(r.h2,{id:"-step-5-check-model-performance",children:"\u2705 Step 5: Check Model Performance"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-python",children:'training_summary = model.summary\r\nprint("RMSE:", training_summary.rootMeanSquaredError)\r\nprint("R2:", training_summary.r2)\n'})}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.strong,{children:"\ud83d\udca1 What This Does:"})}),"\n",(0,i.jsxs)(r.table,{children:[(0,i.jsx)(r.thead,{children:(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.th,{children:"Metric"}),(0,i.jsx)(r.th,{children:"Meaning"})]})}),(0,i.jsxs)(r.tbody,{children:[(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"RMSE"})}),(0,i.jsx)(r.td,{children:"Root Mean Square Error \u2013 lower is better (how far predictions are off)"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"R\xb2"})}),(0,i.jsx)(r.td,{children:"R-squared \u2013 closer to 1 means the model fits data well"})]})]})]}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.strong,{children:"Result"})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-text",children:"RMSE: 5.47\r\nR2: 0.98\n"})}),"\n",(0,i.jsx)(r.p,{children:"\u2705 Your model explains 98% of the variance in the data. That's great!"}),"\n",(0,i.jsx)(r.h2,{id:"-step-6-make-predictions-on-training-data",children:"\u2705 Step 6: Make Predictions on Training Data"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-python",children:"predictions = model.transform(df_features)\r\npredictions.show()\n"})}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.strong,{children:"Result"})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-text",children:"| features | price | prediction |\r\n| -------- | ----- | ---------- |\r\n| [850.0]  | 100   | 100.0      |\r\n| [900.0]  | 120   | 110.0      |\r\n| [1000.0] | 150   | 130.0      |\r\n| [1200.0] | 200   | 170.0      |\r\n| [1500.0] | 250   | 230.0      |\n"})}),"\n",(0,i.jsx)(r.p,{children:"\ud83d\udc49 Predictions are close to real prices (but not perfect)."}),"\n",(0,i.jsx)(r.h2,{id:"-step-7-predict-new-unseen-data",children:"\u2705 Step 7: Predict New (Unseen) Data"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-python",children:'new_data = spark.createDataFrame([(1100,), (1400,)], ["size"])\r\nnew_features = assembler.transform(new_data).select("features")\r\nnew_predictions = model.transform(new_features)\r\nnew_predictions.show()\n'})}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.strong,{children:"\ud83d\udca1 What This Does:"})}),"\n",(0,i.jsxs)(r.table,{children:[(0,i.jsx)(r.thead,{children:(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.th,{children:"Line"}),(0,i.jsx)(r.th,{children:"Meaning"})]})}),(0,i.jsxs)(r.tbody,{children:[(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"createDataFrame(...)"})}),(0,i.jsx)(r.td,{children:'Makes a new DataFrame with only "size"'})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"transform(...)"})}),(0,i.jsx)(r.td,{children:"Turns size into feature vector"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"model.transform(...)"})}),(0,i.jsx)(r.td,{children:"Applies trained model to make predictions"})]})]})]}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.strong,{children:"Result"})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-text",children:"| features | prediction |\r\n| -------- | ---------- |\r\n| [1100.0] | 150.0      |\r\n| [1400.0] | 210.0      |\n"})}),"\n",(0,i.jsx)(r.p,{children:"\u2705 Model can now predict future house prices based on size!"}),"\n",(0,i.jsx)(r.h2,{id:"-1-minute-summary---predict-house-price-with-linear-regression",children:"\ud83d\udd11 1-Minute Summary - Predict House Price with Linear Regression"}),"\n",(0,i.jsxs)(r.table,{children:[(0,i.jsx)(r.thead,{children:(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.th,{children:"Step"}),(0,i.jsx)(r.th,{children:"What Happens"})]})}),(0,i.jsxs)(r.tbody,{children:[(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"Raw Data"}),(0,i.jsx)(r.td,{children:"Create table of house size and price"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"Feature Assembly"}),(0,i.jsxs)(r.td,{children:["Convert size \u2192 ",(0,i.jsx)(r.code,{children:"[size]"})," vector for Spark ML"]})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"Model Training"}),(0,i.jsxs)(r.td,{children:["Fit linear regression model to learn ",(0,i.jsx)(r.code,{children:"w"})," and ",(0,i.jsx)(r.code,{children:"b"})]})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"View Coefficients"}),(0,i.jsx)(r.td,{children:"See how size affects price"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"Evaluate Model"}),(0,i.jsx)(r.td,{children:"Check RMSE and R\xb2 to measure how good the model is"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"Predict Existing Data"}),(0,i.jsx)(r.td,{children:"See how close predictions are to real prices"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"Predict New Data"}),(0,i.jsx)(r.td,{children:"Use model to forecast unseen house prices"})]})]})]}),"\n",(0,i.jsx)(r.p,{children:"\ud83d\udccc This is how machine learning models are built from the ground up \u2014 one clean step at a time."})]})}function o(e={}){const{wrapper:r}={...(0,t.R)(),...e.components};return r?(0,i.jsx)(r,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},8453:(e,r,s)=>{s.d(r,{R:()=>d,x:()=>a});var n=s(6540);const i={},t=n.createContext(i);function d(e){const r=n.useContext(t);return n.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function a(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:d(e.components),n.createElement(t.Provider,{value:r},e.children)}}}]);